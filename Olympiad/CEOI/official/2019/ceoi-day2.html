<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- saved from url=(0039)https://codeforces.com/blog/entry/68748 -->
<html class="gr__codeforces_com"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="X-Csrf-Token" content="a400a051aa98a0c1e1e5c21297bdc579">
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01">
    <script src="./ceoi-day2_files/sdk.js" async="" crossorigin="anonymous"></script><script type="text/javascript" async="" src="./ceoi-day2_files/ga.js"></script><script id="facebook-jssdk" src="./ceoi-day2_files/sdk(1).js"></script><script type="text/javascript" src="./ceoi-day2_files/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }
    </script>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="f1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90">
    <meta property="fb:admins" content="100001352546622">
    <meta property="og:image" content="//sta.codeforces.com/s/16651/images/codeforces-telegram-square.png">
    <link rel="image_src" href="https://sta.codeforces.com/s/16651/images/codeforces-telegram-square.png">
    <meta property="og:title" content="CEOI 2019 Mirror Day 2 - Codeforces">
    <meta property="og:description" content="">
    
    <meta property="og:site_name" content="Codeforces">
    <meta name="uc" content="2d4a0670b5048ef509b25d260f546eb1aa2b93b2">
    <meta name="usmc" content="fdd9141a419c283c10906f413e350f20aeab2fa6">
    
    
    
    
    <meta name="utc_offset" content="+03:00">
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2">
    <title>CEOI 2019 Mirror Day 2 - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community">
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup">
    <meta name="robots" content="index, follow">

    <link rel="stylesheet" href="./ceoi-day2_files/font-awesome.min.css" type="text/css" charset="utf-8">

        <link href="./ceoi-day2_files/css" rel="stylesheet" type="text/css">
        <link href="./ceoi-day2_files/css(1)" rel="stylesheet" type="text/css">


    <link rel="shortcut icon" type="image/png" href="https://sta.codeforces.com/s/16651/favicon.png">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="./ceoi-day2_files/prettify.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./ceoi-day2_files/clear.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./ceoi-day2_files/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./ceoi-day2_files/ttypography.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./ceoi-day2_files/problem-statement.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./ceoi-day2_files/second-level-menu.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./ceoi-day2_files/roundbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./ceoi-day2_files/datatable.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./ceoi-day2_files/table-form.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./ceoi-day2_files/topic.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./ceoi-day2_files/jquery.jgrowl.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./ceoi-day2_files/facebox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./ceoi-day2_files/jquery.wysiwyg.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./ceoi-day2_files/jquery.autocomplete.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./ceoi-day2_files/codeforces.datepick.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./ceoi-day2_files/colorbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./ceoi-day2_files/jquery.drafts.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="./ceoi-day2_files/community.css" type="text/css" charset="utf-8">

    <!-- MathJax -->
    <script type="text/x-mathjax-config;executed=true">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    </script>
    <script type="text/javascript" async="" src="./ceoi-day2_files/MathJax.js">
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="./ceoi-day2_files/prettify.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/pushstream.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/jquery.easing.min.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/jquery.swipe.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/facebox.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/wysiwyg.table.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/wysiwyg.image.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/wysiwyg.link.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/jquery.datepick.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/jquery.drafts.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/clipboard.min.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/autosize.min.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/sjcl.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/codeforces-options.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/codeforces.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/EventCatcher.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/preparedVerdictFormats-en.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="./ceoi-day2_files/style(1).css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="./ceoi-day2_files/style(2).css" type="text/css" charset="utf-8">


    <script type="text/javascript" src="./ceoi-day2_files/jquery.markitup.js"></script>
    <script type="text/javascript" src="./ceoi-day2_files/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->



<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_dialog_advanced{border-radius:8px;padding:10px}.fb_dialog_content{background:#fff;color:#373737}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{left:5px;right:auto;top:5px}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{height:100%;left:0;margin:0;overflow:visible;position:absolute;top:-10000px;transform:none;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{background:none;height:auto;min-height:initial;min-width:initial;width:auto}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{clear:both;color:#fff;display:block;font-size:18px;padding-top:20px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .4);bottom:0;left:0;min-height:100%;position:absolute;right:0;top:0;width:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_mobile .fb_dialog_iframe{position:sticky;top:0}.fb_dialog_content .dialog_header{background:linear-gradient(from(#738aba), to(#2c4987));border-bottom:1px solid;border-color:#1d3c78;box-shadow:white 0 1px 1px -1px inset;color:#fff;font:bold 14px Helvetica, sans-serif;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:linear-gradient(from(#4267B2), to(#2a4887));background-clip:padding-box;border:1px solid #29487d;border-radius:3px;display:inline-block;line-height:18px;margin-top:3px;max-width:85px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{background:none;border:none;color:#fff;font:bold 12px Helvetica, sans-serif;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #4a4a4a;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f5f6f7;border:1px solid #4a4a4a;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-position:50% 50%;background-repeat:no-repeat;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none; box-sizing: content-box}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_test {font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.MathJax_test.mjx-test-display {display: table!important}
.MathJax_test.mjx-test-inline {display: inline!important; margin-right: -1px}
.MathJax_test.mjx-test-default {display: block!important; clear: both}
.MathJax_ex_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.MathJax_em_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60em}
.mjx-test-inline .MathJax_left_box {display: inline-block; width: 0; float: left}
.mjx-test-inline .MathJax_right_box {display: inline-block; width: 0; float: right}
.mjx-test-display .MathJax_right_box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body data-gr-c-s-loaded="true"><div id="MathJax_Message" style="display: none;"></div><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><span style="display:none;" class="csrf-token" data-csrf="a400a051aa98a0c1e1e5c21297bdc579">&nbsp;</span>
<div class="button-up" style="opacity: 0.7; width: 50px; height: 100%; position: fixed; left: 0px; top: 0px; cursor: pointer; text-align: center; line-height: 35px; color: rgb(211, 219, 228); font-weight: bold; font-size: 3rem; display: none;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile == "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>
<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>


<script type="text/javascript">
    window.fbAsyncInit = function() {
        FB.init({
            appId      : '554666954583323',
            xfbml      : true,
            version    : 'v2.8'
        });
        FB.AppEvents.logPageView();
    };

    (function(d, s, id){
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {return;}
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/en_US/sdk.js";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
</script>


    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 1000
        });
    }, 0);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();

        var count = 0;

        function getDelay() {
            var delay = 0;
            var last = Codeforces.getFromStorage("LastOnlineTimeUpdaterMillis", 0);
            if (last && last != null) {
                var period = count < 20 ? 180 * 1000 : 360 * 1000;
                delay = period - (new Date().getTime() - last);
                if (delay < 0)
                    delay = 0;
            }
            return delay;
        }

        window.setInterval(function () {
            if (getDelay() <= 0 && count < 120) {
                ++count;
                Codeforces.ping("/data/update-online");
            }
        }, 5000);

        var handle = "mostafa.saad.fci";
        $("a.rated-user:contains(" + handle + "), span.participant:contains(" + handle + ")").each(function () {
            if ($(this).text() == handle) {
                var td = $(this).parent();
                var tr = $(this).parent().parent();
                if (td.is("td") && tr.is("tr")) {
                    tr.addClass("highlighted-row");
                }
            }
        });

    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }
        // console.log("Got announcement from channel");
        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");


    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function () {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = (document.location.protocol == 'https:' ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


<div id="body">
            <script type="application/javascript">
                window.setTimeout(function () {
                    var url = location.href;
                    var hashCode32 = Math.abs(url.hashCode()).toString();
                    var hashCode = "p" + hashCode32 + Math.abs((hashCode32 + url).hashCode());
                    var pvs = Codeforces.getFromStorage("pvs" + hashCode);
                    if (!pvs) {
                        $.post("/data/apv", {
                            ftaa: window._ftaa,
                            bfaa: window._bfaa,
                            url: url
                        }, function (json) {
                            if (json["success"] === "true") {
                                Codeforces.putToStorage("pvs" + hashCode, true);
                            }
                        }, "json");
                    }
                }, 5000);
            </script>
        

<div class="side-bell" style="visibility: hidden; opacity: 0.7; width: 40px; position: fixed; right: 0px; top: 0px; cursor: pointer; text-align: center; line-height: 35px; color: rgb(211, 219, 228); font-weight: bold; font-size: 1.5rem; display: none;">
    <span class="icon-stack" style="width: 100%;">
        <i class="icon-circle icon-stack-base"></i>
        <i class="icon-bell-alt icon-light"></i>
    </span>
    <br>
    <span class="side-bell__count" style="position: relative; top: -10px;"></span>
</div>




<style>
    .header-bell {
        display: inline-block;
        position: relative;
        cursor: pointer;
    }

    .header-bell__img {
        opacity: 0.5;
        background-image: url("//sta.codeforces.com/s/16651/images/icons/bell_inactive-20x20.png");
        position: relative;
        bottom: 1px;
        width: 20px;
        height: 20px;
    }

    .header-bell__img-active  {
        opacity: 1 !important;
        background-image: url("//sta.codeforces.com/s/16651/images/icons/bell_active-20x20.png") !important;
    }

    .header-bell__count {
        position: absolute;
        top: 8px;
        left: 18px;
        font-weight: bold;
        font-size: 10px;
    }

    .bell-details {
        display: none;
        z-index: 5;
        border: 1px solid rgb(185, 185, 185);
        width: 40rem;
        max-height: 60rem;
        padding: 0;
        position: absolute;
        top: 20px;
        right: 0;
        background-color: white;
        overflow: scroll;
        overflow-x: hidden;
        overflow-y: auto;
    }
    .bell-details.sidebar-bell {
        position: fixed;
        right: 50px;
    }

    .bell-details__no-new {
        font-size: 1.3rem;
        display: block;
        text-align: center;
        color: #888 !important;
        padding: 1em;
    }

    .bell-details__recent-link {
        margin: 0;
        padding: 0.5em;
        text-align: center;
        border-top: 1px solid rgb(185, 185, 185);
    }

    .bell-details__recent-link a {
        font-size: 1.2rem;
    }

    .bell-details__proto-row-comment {
        display: none;
    }

    .bell-details__proto-row-blog-entry {
        display: none;
    }

    .bell-details__proto-row-comment-reply {
        display: none;
    }

    .bell-details__row {
        text-align: left;
        margin: 0.5em;
        padding: 0.25em 0.25em 0.75em 0.25em;
        clear: both;
    }

    .bell-details__row:hover {
        cursor: pointer;
        background-color: #def;
    }

    .bell-details__row-active {
        background-color: #def;
    }

    .bell-details__thumbnail-a {
        text-decoration: none;
    }

    .bell-details__row img {
        zoom: 50%;
        margin-right: 2em;
        float: left;
    }

    .bell-details__comment {
        padding-left: 45px;
        font-size: 1.3rem;
    }

    .bell-details__blog-entry {
        padding-left: 45px;
        font-size: 1.3rem;
    }

    .bell-details__comment-reply {
        padding-left: 45px;
        font-size: 1.3rem;
    }

    .bell-details__time {
        padding-left: 45px;
        margin-top: 0.2em;
        font-size: 1.1rem;
        color: #888 !important;
    }
</style>

<script>
    $(function () {
        if ($(window).width() < 1600) {
            $('.side-bell').css('width', '30px').css('line-height', '30px').css('font-size', '10px');
        }

        if ($(window).width() >= 1200) {
            $ (window).scroll (function () {
                if ($ (this).scrollTop () > 100) {
                    $(".bell-details").addClass("sidebar-bell");
                    $ ('.side-bell').fadeIn();
                } else {
                    $(".bell-details").removeClass("sidebar-bell");
                    $ ('.side-bell').fadeOut();
                }
            });

            $('.side-bell').hover(function () {
                $(this).animate({
                    'opacity':'1'
                }).css({'color':'#6a86a4'});
            }, function () {
                $(this).animate({
                    'opacity':'0.7'
                }).css({'color':'#d3dbe4'});
            });
        }

        $(".lang-chooser>div:first-child").prepend($("<span style='position: relative; bottom: 8px; padding: 0 0.5em;'>|</span>")).prepend($(".header-bell").show());
        function Bell() {
            var bell = this;
            var notifications = JSON.parse("[]");

            bell.notifications = {};

            for (var i in notifications) {
                if (notifications.hasOwnProperty(i)) {
                    bell.notifications[notifications[i].id] = notifications[i];
                }
            }

            function onClick(notification) {
                var notificationIds = [];
                var reason = notification.data.reasonType + "#" + notification.reasonId;
                for (id in bell.notifications) {
                    if (bell.notifications.hasOwnProperty(id)) {
                        var otherNotification = bell.notifications[id];
                        var otherReason = otherNotification.data.reasonType + "#" + otherNotification.reasonId;
                        if (otherReason == reason) {
                            notificationIds.push(otherNotification.id);
                        }
                    }
                }
                $.post("/data/notification", {action: "markAsRead", notificationIds: notificationIds.join(",")}, function(result) {
                    Codeforces.redirect(notification.data.url);
                }, "json");
            }

            var $bellDetails = $(".bell-details");
            bell.newCommentRow = function (notification) {
                var row = $(".bell-details__proto-row-comment").clone();
                row.addClass("bell-details__row").attr("data-notificationId", notification.id);
                row.find(".bell-details__thumbnail-a").attr("href", notification.data.reasonUserUrl);
                row.find("img").attr("src", notification.data.reasonUserThumbnailUrl);
                row.find(".bell-details__comment").html(
                        "ReasonUser mentioned you in a comment".replace("ReasonUser", notification.data.reasonUserHtml)
                );
                row.find(".bell-details__time").html(
                        "<span class='format-systemtimewithseconds'>"
                        + notification.creationTimeString
                        + "</span>"
                );
                row.removeClass("bell-details__proto-row-comment");
                row.click(function() {
                    onClick(notification);
                    return false;
                });
                return row;
            };
            bell.newFriendCommentRow = function (notification) {
                var row = $(".bell-details__proto-row-comment").clone();
                row.addClass("bell-details__row").attr("data-notificationId", notification.id);
                row.find(".bell-details__thumbnail-a").attr("href", notification.data.reasonUserUrl);
                row.find("img").attr("src", notification.data.reasonUserThumbnailUrl);
                row.find(".bell-details__comment").html(
                        "ReasonUser wrote a comment".replace("ReasonUser", notification.data.reasonUserHtml)
                );
                row.find(".bell-details__time").html(
                        "<span class='format-systemtimewithseconds'>"
                        + notification.creationTimeString
                        + "</span>"
                );
                row.removeClass("bell-details__proto-row-comment");
                row.click(function() {
                    onClick(notification);
                    return false;
                });
                return row;
            };
            bell.newCommentReplyRow = function (notification) {
                var row = $(".bell-details__proto-row-comment-reply").clone();
                row.addClass("bell-details__row").attr("data-notificationId", notification.id);
                row.find(".bell-details__thumbnail-a").attr("href", notification.data.reasonUserUrl);
                row.find("img").attr("src", notification.data.reasonUserThumbnailUrl);
                row.find(".bell-details__comment-reply").html(
                        "ReasonUser replied to your comment".replace("ReasonUser", notification.data.reasonUserHtml)
                );
                row.find(".bell-details__time").html(
                        "<span class='format-systemtimewithseconds'>"
                        + notification.creationTimeString
                        + "</span>"
                );
                row.removeClass("bell-details__proto-row-comment-reply");
                row.click(function() {
                    onClick(notification);
                    return false;
                });
                return row;
            };
            bell.newBlogEntryRow = function (notification) {
                var row = $(".bell-details__proto-row-blog-entry").clone();
                row.addClass("bell-details__row").attr("data-notificationId", notification.id);
                row.find(".bell-details__thumbnail-a").attr("href", notification.data.reasonUserUrl);
                row.find("img").attr("src", notification.data.reasonUserThumbnailUrl);
                row.find(".bell-details__blog-entry").html(
                        "ReasonUser mentioned you in a blog entry".replace("ReasonUser", notification.data.reasonUserHtml)
                );
                row.find(".bell-details__time").html(
                        "<span class='format-systemtimewithseconds'>"
                        + notification.creationTimeString
                        + "</span>"
                );
                row.removeClass("bell-details__proto-row-blog-entry");
                row.click(function() {
                    onClick(notification);
                    return false;
                });
                return row;
            };
            bell.newFriendBlogEntryRow = function (notification) {
                var row = $(".bell-details__proto-row-blog-entry").clone();
                row.addClass("bell-details__row").attr("data-notificationId", notification.id);
                row.find(".bell-details__thumbnail-a").attr("href", notification.data.reasonUserUrl);
                row.find("img").attr("src", notification.data.reasonUserThumbnailUrl);
                row.find(".bell-details__blog-entry").html(
                        "ReasonUser wrote a blog entry".replace("ReasonUser", notification.data.reasonUserHtml)
                );
                row.find(".bell-details__time").html(
                        "<span class='format-systemtimewithseconds'>"
                        + notification.creationTimeString
                        + "</span>"
                );
                row.removeClass("bell-details__proto-row-blog-entry");
                row.click(function() {
                    onClick(notification);
                    return false;
                });
                return row;
            };
            bell.newProposalCommentRow = function (notification) {
                var row = $(".bell-details__proto-row-comment-reply").clone();
                row.addClass("bell-details__row").attr("data-notificationId", notification.id);
                row.find(".bell-details__thumbnail-a").attr("href", notification.data.reasonUserUrl);
                row.find("img").attr("src", notification.data.reasonUserThumbnailUrl);
                row.find(".bell-details__comment-reply").html(
                        "ReasonUser commented on ProposalType Proposal".replace("ReasonUser", notification.data.reasonUserHtml)
                                .replace("ProposalType", "Contest" == notification.data.proposalType ? "contest proposal" : "problem proposal")
                                .replace("Proposal", $("<div/>").text(notification.data.proposalName).html())
                );
                row.find(".bell-details__time").html(
                        "<span class='format-systemtimewithseconds'>"
                        + notification.creationTimeString
                        + "</span>"
                );
                row.removeClass("bell-details__proto-row-comment-reply");
                row.click(function() {
                    onClick(notification);
                    return false;
                });
                return row;
            };

            bell.renderRow = function (notification) {
                var $row = $(".bell-details__row[data-notificationId='" + notification.id + "']");

                if ($bellDetails.css("display") != "block" && notification.read) {
                    $row.hide();
                    return;
                }

                notification.data = JSON.parse(notification.dataJson);

                var reason = notification.data.reasonType + "#" + notification.reasonId;

                var has = false;
                $row.each(function () {
                    has = true;
                });
                if ($(".bell-details__row[data-reason='" + reason + "']").length) {
                    has = true;
                }

                if (!has) {
                    $(".side-bell").css("visibility", "visible");
                    var newRow;
                    if (notification.type == "Comment") {
                        newRow = bell.newCommentRow(notification);
                    } else if (notification.type == "BlogEntry") {
                        newRow = bell.newBlogEntryRow(notification);
                    } else if (notification.type == "CommentReply") {
                        newRow = bell.newCommentReplyRow(notification);
                    } else if (notification.type == "FriendComment") {
                        newRow = bell.newFriendCommentRow(notification);
                    } else if (notification.type == "FriendBlogEntry") {
                        newRow = bell.newFriendBlogEntryRow(notification);
                    } else if (notification.type == "ProposalComment") {
                        newRow = bell.newProposalCommentRow(notification)
                    }
                    if (newRow) {
                        newRow.attr("data-reason", reason);
                        $(".bell-details").prepend(newRow);
                    }
                }
            };

            var $count = $(".header-bell__count, .side-bell__count");
            var $img = $(".header-bell__img");
            var $noNew = $(".bell-details__no-new");

            bell.renewCount = function () {
                Codeforces.reformatTimes();
                var count = 0;
                var counted = {};
                for (var id in bell.notifications)
                    if (bell.notifications.hasOwnProperty(id)) {
                        var notification = bell.notifications[id];
                        if (notification) {
                            var reason = notification.data.reasonType + "#" + notification.reasonId;
                            if (!notification.read && !counted[reason]) {
                                count++;
                                counted[reason] = true;
                            }
                        }
                    }
                if (count > 0) {
                    $count.text(count);
                    $img.addClass("header-bell__img-active");
                    $noNew.hide();
                } else {
                    $count.text("");
                    $img.removeClass("header-bell__img-active");
                    if ($bellDetails.css("display") != "block") {
                        $noNew.show();
                    }
                }
            };

            for (var id in bell.notifications)
                if (bell.notifications.hasOwnProperty(id))
                    bell.renderRow(bell.notifications[id]);

            if (window.eventCatcher) {
                window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                    if (json.t === "n") {
                        for (var i in json.d)
                            if (json.d.hasOwnProperty(i)) {
                                var notification = json.d[i];
                                notification.data = JSON.parse(notification.dataJson);
                                bell.notifications[notification.id] = notification;
                                bell.renderRow(notification);
                                bell.renewCount();
                            }
                    }
                });
            }


            $(".header-bell, .side-bell").click(function() {
                if ($bellDetails.css("display") == "none") {
                    for (var id in bell.notifications)
                        if (bell.notifications.hasOwnProperty(id))
                            if (bell.notifications[id].read)
                                bell.renderRow(bell.notifications[id]);
                    bell.renewCount();

                    $bellDetails.css("display", "block");

                    var notificationIds = [];
                    for (id in bell.notifications)
                        if (bell.notifications.hasOwnProperty(id))
                            notificationIds.push(id);

                    setTimeout(function() {
                        if ($bellDetails.css("display") == "block") {
                            $.post("/data/notification", {action: "markAsRead", notificationIds: notificationIds.join(",")}, function(result) {
                                // No operations.
                            }, "json");

                            for (var i in notificationIds) {
                                if (notificationIds.hasOwnProperty(i)) {
                                    bell.notifications[notificationIds[i]].read = true;
                                }
                            }
                            bell.renewCount();
                        }
                    }, 2000);
                } else {
                    var has = false;
                    for (var id in bell.notifications) {
                        if (bell.notifications.hasOwnProperty(id) && !bell.notifications[id].read) {
                            has = true;
                        }
                    }
                    if (!has) {
                        $(".side-bell").css("visibility", "hidden");
                    }
                    $bellDetails.css("display", "none");
                    bell.renewCount();
                }
            });
        }

        bell = new Bell();
        bell.renewCount();
    })
</script>

<div id="header" style="position: relative;">
    <div style="float:left;">
            <a href="https://codeforces.com/"><img src="./ceoi-day2_files/codeforces-logo-with-telegram.png"></a>
    </div>
    <div class="lang-chooser">
        <div style="text-align: right;"><div class="header-bell" style="">
    <div class="header-bell__img"><span class="header-bell__count"></span></div>

    <div class="bell-details">
        <div class="bell-details__proto-row-comment">
            <a class="bell-details__thumbnail-a" href="https://codeforces.com/blog/entry/68748#"><img src="https://codeforces.com/blog/entry/68748"></a>
            <div class="bell-details__comment"></div>
            <div class="bell-details__time"></div>
        </div>
        <div class="bell-details__proto-row-blog-entry">
            <a class="bell-details__thumbnail-a" href="https://codeforces.com/blog/entry/68748#"><img src="https://codeforces.com/blog/entry/68748"></a>
            <div class="bell-details__blog-entry"></div>
            <div class="bell-details__time"></div>
        </div>
        <div class="bell-details__proto-row-comment-reply">
            <a class="bell-details__thumbnail-a" href="https://codeforces.com/blog/entry/68748#"><img src="https://codeforces.com/blog/entry/68748"></a>
            <div class="bell-details__comment-reply"></div>
        </div>

        <div class="bell-details__no-new">
            There are no new notifications
        </div>

        <div class="bell-details__recent-link">
            <a href="https://codeforces.com/notifications">History (at most 100 notifications)</a>
        </div>
    </div>
</div><span style="position: relative; bottom: 8px; padding: 0 0.5em;">|</span>
            <a href="https://codeforces.com/blog/entry/68748?locale=en"><img src="./ceoi-day2_files/gb.png" title="In English" alt="In English"></a>
            <a href="https://codeforces.com/blog/entry/68748?locale=ru"><img src="./ceoi-day2_files/ru.png" title="-" alt="-"></a>
        </div>

        <div>
                        <a href="https://codeforces.com/profile/mostafa.saad.fci">mostafa.saad.fci</a>
                     | 
                        <a href="https://codeforces.com/256f65af28fb118222c045530e11939f/logout">Logout</a>
                    
        </div>



    </div>
    <br style="clear: both;">
</div>
        

    <div class="roundbox menu-box" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
    <div class="menu-list-container">
    <ul class="menu-list main-menu-list">
                <li class=""><a href="https://codeforces.com/">Home</a></li>
                <li class=""><a href="https://codeforces.com/top">Top</a></li>
                <li class=""><a href="https://codeforces.com/contests">Contests</a></li>
                <li class=""><a href="https://codeforces.com/gyms">Gym</a></li>
                <li class=""><a href="https://codeforces.com/problemset">Problemset</a></li>
                <li class=""><a href="https://codeforces.com/groups">Groups</a></li>
                <li class=""><a href="https://codeforces.com/ratings">Rating</a></li>
                <li class=""><a href="https://codeforces.com/api/help">API</a></li>
                <li class=""><a href="https://codeforces.com/help">Help</a></li>
                <li class=""><a href="https://codeforces.com/calendar">Calendar</a></li>
    </ul>
        <form method="post" action="https://codeforces.com/search"><input type="hidden" name="csrf_token" value="a400a051aa98a0c1e1e5c21297bdc579">
            <input class="search" name="query" data-isplaceholder="true" value="">
        <input type="hidden" name="_tta" value="187"></form>
    <br style="clear: both;">
</div>

    </div>

    <script type="text/javascript">
        $(document).ready(function () {
            $("input.search").focus(function () {
                if ($(this).attr("data-isPlaceholder") === "true") {
                    $(this).val("");
                    $(this).removeAttr("data-isPlaceholder");
                }
            });
        });
    </script>
            <br style="height: 3em; clear: both;">

        <div style="position: relative;">
                        <div id="sidebar">
    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled"> Pay attention
            <div class="top-links">
            </div>
        </div>
<div style="padding: 0.5em;">
        <div style="text-align:center;border-bottom: 1px solid rgb(185, 185, 185);margin:0 -0.5em 0.5em -0.5em;padding: 0 1em 0.5em 1em;">
            <span class="contest-state-phase">Before contest</span><br><a href="https://codeforces.com/contests/1198,1199">Codeforces Round #576 (Div. 1)</a><br><span class="countdown" home="//sta.codeforces.com/s/16651" noredirection="true" textbeforeredirect="" cdid="i1">09:41:01</span>
        </div>
        <div style="text-align:center;border-bottom: 1px solid rgb(185, 185, 185);margin:0 -0.5em 0.5em -0.5em;padding: 0 1em 0.5em 1em;">
            <span class="contest-state-phase">Before contest</span><br><a href="https://codeforces.com/contests/1198,1199">Codeforces Round #576 (Div. 2)</a><br><span class="countdown" home="//sta.codeforces.com/s/16651" noredirection="true" textbeforeredirect="" cdid="i2">09:41:02</span><br><a href="https://codeforces.com/contestRegistration/1199">Register now </a><div class="smaller notice">*has extra registration<i class="icon-question-sign clickable-title" title="If you are late to register in 5 minutes before the start, you can register later during the extra registration. Extra registration opens 10 minutes after the contest starts and lasts 50 minutes." style="position: relative; bottom: 3px;"></i></div>
        </div>
        <div style="text-align:center;">
            <div class="socials" style="text-align: left;">
                <div style="margin-top: 0.85em;position: relative;">

        <div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; width: 0px; height: 0px;"><div></div><div><iframe name="fb_xdm_frame_https" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" src="./ceoi-day2_files/xd_arbiter.html" style="border: none;"></iframe></div></div></div>
        <script>
        (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/en_EN/all.js#appId=554666954583323&xfbml=1";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
        </script>
        <div class="fb-like fb_iframe_widget" data-href="//codeforces.com/contests/1198,1199" data-send="false" data-width="256" data-show-faces="false" data-font="arial" data-ref="1820883341" fb-xfbml-state="rendered" fb-iframe-plugin-query="app_id=554666954583323&amp;container_width=264&amp;font=arial&amp;href=https%3A%2F%2Fcodeforces.com%2Fcontests%2F1198%2C1199&amp;locale=en_US&amp;ref=1820883341&amp;sdk=joey&amp;send=false&amp;show_faces=false&amp;width=256"><span style="vertical-align: bottom; width: 256px; height: 28px;"><iframe name="f1dc0711b9b12e" width="256px" height="1000px" title="fb:like Facebook Social Plugin" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" src="./ceoi-day2_files/like.html" style="border: none; visibility: visible; width: 256px; height: 28px;" class=""></iframe></span></div>

        </div>
</div>

        </div>
</div>
    </div>

    <style>
        .personal-sidebar {
            margin: 1em;
        }

        .personal-sidebar .for-avatar {
            float: right;
        }

        .personal-sidebar li {
            font-size: 0.8em;
        }

        .personal-sidebar .nav-links {
            margin-top: 0.5em;
        }

        .personal-sidebar .nav-links li {
            list-style: disc;
            list-style-position: inside;
        }

        .personal-sidebar .propertyLinks li img {
            margin-right: 0.5em;
        }
    </style>

    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled"> mostafa.saad.fci
            <div class="top-links">
            </div>
        </div>
    <div class="personal-sidebar">
<div class="for-avatar"><div class="avatar"><a href="https://codeforces.com/profile/mostafa.saad.fci" style="position: relative;"><img src="./ceoi-day2_files/27d8267229d63351.jpg"></a><div><a href="https://codeforces.com/profile/mostafa.saad.fci" title="Expert mostafa.saad.fci" class="rated-user user-blue">mostafa.saad.fci</a></div></div></div><div><ul class="propertyLinks"><li><img style="vertical-align:middle;position:relative;top:-2px" src="./ceoi-day2_files/rating-16x16.png" alt="User&#39;&#39;s contest rating in Codeforces community" title="User&#39;&#39;s contest rating in Codeforces community">Rating:&nbsp;<span style="font-weight:bold;" class="user-blue">1605</span></li><li><img style="vertical-align:middle;position:relative;top:-2px" src="./ceoi-day2_files/star_blue_16.png" alt="User&#39;&#39;s contribution into Codeforces community" title="User&#39;&#39;s contribution into Codeforces community">Contribution:&nbsp;<span style="color:green;font-weight:bold;">+67</span></li></ul><ul class="nav-links"><li><a href="https://codeforces.com/settings/general">Settings</a></li><li><a href="https://codeforces.com/blog/mostafa.saad.fci">Blog</a></li><li><a href="https://codeforces.com/teams">Teams</a></li><li><a href="https://codeforces.com/submissions/mostafa.saad.fci">Submissions</a></li><li><a href="https://codeforces.com/favourite/contests">Favourites</a></li><li><a href="https://codeforces.com/contests/writer/mostafa.saad.fci">Problemsetting</a></li><li><a href="https://codeforces.com/groups/with/mostafa.saad.fci">Groups</a></li><li><a href="https://codeforces.com/usertalk">Talks</a></li><li><a href="https://codeforces.com/contests/with/mostafa.saad.fci">Contests</a></li></ul></div><br style="clear:both;">    </div>
    </div>
<div class="roundbox sidebox top-contributed" style="">
<div class="roundbox-lt">&nbsp;</div>
<div class="roundbox-rt">&nbsp;</div>
<div class="caption titled"> Top rated
<div class="top-links">
</div>
</div>
<table class="rtable ">
<tbody>
<tr>
<th class="left" style="width:2.25em;">#</th>
<th class="">User</th>
<th class="" style="width:5em;">Rating</th>
</tr>
<tr>
<td class="left dark">1</td>
<td class=" dark"><a href="https://codeforces.com/profile/tourist" title="Legendary grandmaster tourist" class="rated-user user-legendary"><span class="legendary-user-first-letter">t</span>ourist</a></td>
<td class=" dark">3686</td>
</tr>
<tr>
<td class="left ">2</td>
<td class=""><a href="https://codeforces.com/profile/LHiC" title="Legendary grandmaster LHiC" class="rated-user user-legendary"><span class="legendary-user-first-letter">L</span>HiC</a></td>
<td class="">3336</td>
</tr>
<tr>
<td class="left dark">3</td>
<td class=" dark"><a href="https://codeforces.com/profile/wxhtxdy" title="Legendary grandmaster wxhtxdy" class="rated-user user-legendary"><span class="legendary-user-first-letter">w</span>xhtxdy</a></td>
<td class=" dark">3329</td>
</tr>
<tr>
<td class="left ">4</td>
<td class=""><a href="https://codeforces.com/profile/Benq" title="Legendary grandmaster Benq" class="rated-user user-legendary"><span class="legendary-user-first-letter">B</span>enq</a></td>
<td class="">3311</td>
</tr>
<tr>
<td class="left dark">5</td>
<td class=" dark"><a href="https://codeforces.com/profile/Um_nik" title="Legendary grandmaster Um_nik" class="rated-user user-legendary"><span class="legendary-user-first-letter">U</span>m_nik</a></td>
<td class=" dark">3301</td>
</tr>
<tr>
<td class="left ">6</td>
<td class=""><a href="https://codeforces.com/profile/V--o_o--V" title="Legendary grandmaster V--o_o--V" class="rated-user user-legendary"><span class="legendary-user-first-letter">V</span>--o_o--V</a></td>
<td class="">3275</td>
</tr>
<tr>
<td class="left dark">7</td>
<td class=" dark"><a href="https://codeforces.com/profile/Radewoosh" title="Legendary grandmaster Radewoosh" class="rated-user user-legendary"><span class="legendary-user-first-letter">R</span>adewoosh</a></td>
<td class=" dark">3268</td>
</tr>
<tr>
<td class="left ">8</td>
<td class=""><a href="https://codeforces.com/profile/yutaka1999" title="Legendary grandmaster yutaka1999" class="rated-user user-legendary"><span class="legendary-user-first-letter">y</span>utaka1999</a></td>
<td class="">3190</td>
</tr>
<tr>
<td class="left dark">9</td>
<td class=" dark"><a href="https://codeforces.com/profile/ainta" title="Legendary grandmaster ainta" class="rated-user user-legendary"><span class="legendary-user-first-letter">a</span>inta</a></td>
<td class=" dark">3180</td>
</tr>
<tr>
<td class="left bottom">10</td>
<td class="bottom"><a href="https://codeforces.com/profile/Petr" title="Legendary grandmaster Petr" class="rated-user user-legendary"><span class="legendary-user-first-letter">P</span>etr</a></td>
<td class="bottom">3115</td>
</tr>
</tbody>
</table>
<div class="bottom-links">
<table style="width:100%;">
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://codeforces.com/ratings/countries">Countries</a> |
<a href="https://codeforces.com/ratings/cities">Cities</a> |
<a href="https://codeforces.com/ratings/organizations">Organizations</a>
</td>
<td style="text-align:right;">
<a href="https://codeforces.com/ratings">View all </a>
</td>
</tr>
</tbody>
</table>
</div>
</div><div class="roundbox sidebox top-contributed" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled"> Top contributors
            <div class="top-links">
            </div>
        </div>
        <table class="rtable ">
            <tbody>
                <tr>
                            <th class="left" style="width:2.25em;">#</th>
                            <th class="">User</th>
                            <th class="" style="width:5em;">Contrib.</th>
                </tr>
                    <tr>
                                <td class="left  dark">1</td>
                                <td class=" dark"><a href="https://codeforces.com/profile/Errichto" title="International Grandmaster Errichto" class="rated-user user-red">Errichto</a></td>
                                <td class=" dark">193</td>
                    </tr>
                    <tr>
                                <td class="left ">2</td>
                                <td class=""><a href="https://codeforces.com/profile/Radewoosh" title="Legendary grandmaster Radewoosh" class="rated-user user-legendary"><span class="legendary-user-first-letter">R</span>adewoosh</a></td>
                                <td class="">184</td>
                    </tr>
                    <tr>
                                <td class="left  dark">3</td>
                                <td class=" dark"><a href="https://codeforces.com/profile/rng_58" title="Legendary grandmaster rng_58" class="rated-user user-legendary"><span class="legendary-user-first-letter">r</span>ng_58</a></td>
                                <td class=" dark">164</td>
                    </tr>
                    <tr>
                                <td class="left ">4</td>
                                <td class=""><a href="https://codeforces.com/profile/PikMike" title="International master PikMike" class="rated-user user-orange">PikMike</a></td>
                                <td class="">163</td>
                    </tr>
                    <tr>
                                <td class="left  dark">5</td>
                                <td class=" dark"><a href="https://codeforces.com/profile/Vovuh" title="Candidate Master Vovuh" class="rated-user user-violet">Vovuh</a></td>
                                <td class=" dark">160</td>
                    </tr>
                    <tr>
                                <td class="left ">6</td>
                                <td class=""><a href="https://codeforces.com/profile/majk" title="International Grandmaster majk" class="rated-user user-red">majk</a></td>
                                <td class="">158</td>
                    </tr>
                    <tr>
                                <td class="left  dark">7</td>
                                <td class=" dark"><a href="https://codeforces.com/profile/300iq" title="Legendary grandmaster 300iq" class="rated-user user-legendary"><span class="legendary-user-first-letter">3</span>00iq</a></td>
                                <td class=" dark">152</td>
                    </tr>
                    <tr>
                                <td class="left ">8</td>
                                <td class=""><a href="https://codeforces.com/profile/Um_nik" title="Legendary grandmaster Um_nik" class="rated-user user-legendary"><span class="legendary-user-first-letter">U</span>m_nik</a></td>
                                <td class="">150</td>
                    </tr>
                    <tr>
                                <td class="left  dark">9</td>
                                <td class=" dark"><a href="https://codeforces.com/profile/Petr" title="Legendary grandmaster Petr" class="rated-user user-legendary"><span class="legendary-user-first-letter">P</span>etr</a></td>
                                <td class=" dark">147</td>
                    </tr>
                    <tr>
                                <td class="left bottom">10</td>
                                <td class="bottom"><a href="https://codeforces.com/profile/kostka" title="International Grandmaster kostka" class="rated-user user-red">kostka</a></td>
                                <td class="bottom">144</td>
                    </tr>
            </tbody>
        </table>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="https://codeforces.com/top-contributed">View all </a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function () {
        });
    </script>

    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled"> Find user
            <div class="top-links">
            </div>
        </div>
        <form class="handleForm" method="post" autocomplete="off"><input type="hidden" name="csrf_token" value="a400a051aa98a0c1e1e5c21297bdc579">
            <div style="padding:1em;text-align:right;">
                <label style="padding-right:1em;">Handle:
                    <input style="width:12em;" type="text" class="handleBox ac_input" autocomplete="off">
                </label>
            </div>
            <div style="padding: 0 1em 1em 1em;text-align:right;">
                <input style="height:1.65em;padding:0 0.75em;" type="submit" value="Find">
            </div>
        <input type="hidden" name="_tta" value="187"></form>
    </div>
    <script type="text/javascript">
        $(document).ready(function () {
    $(".handleBox").autocomplete("/data/handles", {
        delay: 200,
        width: 200,
        selectFirst: false,
        matchContains: true,
        minChars: 3
    });
    $(".handleForm").attr("autocomplete", "off").submit(function () {
        var link = "/profile/userHandle".replace(
            "userHandle", $(this).find(".handleBox").val()
        );
        window.location = link;
        return false;
    });
        });
    </script>




    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled"> Recent actions
            <div class="top-links">
            </div>
        </div>
        <div class="recent-actions">
            <ul>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/I_love_HellHoleStudios" title="Specialist I_love_HellHoleStudios" class="rated-user user-cyan">I_love_HellHoleStudios</a>        
        <a href="https://codeforces.com/blog/entry/67252">Chinese OI English Statements Request</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Um_nik" title="Legendary grandmaster Um_nik" class="rated-user user-legendary"><span class="legendary-user-first-letter">U</span>m_nik</a>        
        <a href="https://codeforces.com/blog/entry/68775">Codeforces Round #576 (div.1 + div.2)</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/rocky1234" title="Unrated, rocky1234" class="rated-user user-black">rocky1234</a>        
        <a href="https://codeforces.com/blog/entry/68777">Wrong Judjement or Favouritism to Known coders at Fb Hackercup 2019</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Yuki726" title="Expert Yuki726" class="rated-user user-blue">Yuki726</a>        
        <a href="https://codeforces.com/blog/entry/68776">Goals!!</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Endagorion" title="Legendary grandmaster Endagorion" class="rated-user user-legendary"><span class="legendary-user-first-letter">E</span>ndagorion</a>        
        <a href="https://codeforces.com/blog/entry/16736">Codeforces Round #295 Editorial (now with bonuses!)</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/rocky1234" title="Unrated, rocky1234" class="rated-user user-black">rocky1234</a>        
        <a href="https://codeforces.com/blog/entry/68781">FB Hackercup CHeating </a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/chokudai" title="International master chokudai" class="rated-user user-orange">chokudai</a>        
        <a href="https://codeforces.com/blog/entry/68697">AtCoder Beginner Contest 135 Announcement</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Cursed_Angel" title="Unrated, Cursed_Angel" class="rated-user user-black">Cursed_Angel</a>        
        <a href="https://codeforces.com/blog/entry/68760">help needed in a problem</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/suncongbo" title="Expert suncongbo" class="rated-user user-blue">suncongbo</a>        
        <a href="https://codeforces.com/blog/entry/67839">An O(n) Solution to Codeforces 835D</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/eku" title="Expert eku" class="rated-user user-blue">eku</a>        
        <a href="https://codeforces.com/blog/entry/68780">Request for opinions/reviews of my blog post on segment trees</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Anai" title="Master Anai" class="rated-user user-orange">Anai</a>        
        <a href="https://codeforces.com/blog/entry/68778">"The trick from aliens"</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="./ceoi-day2_files/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/kostka" title="International Grandmaster kostka" class="rated-user user-red">kostka</a>        
        <a href="https://codeforces.com/blog/entry/68770">One easy trick to make $$$</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/ericlong" title="Pupil ericlong" class="rated-user user-green">ericlong</a>        
        <a href="https://codeforces.com/blog/entry/68773">Help with CCO 2018 Boring Lectures</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Geothermal" title="Grandmaster Geothermal" class="rated-user user-red">Geothermal</a>        
        <a href="https://codeforces.com/blog/entry/68730">AtCoder Beginner Contest 135 English Solutions</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/justHusam" title="Candidate Master justHusam" class="rated-user user-violet">justHusam</a>        
        <a href="https://codeforces.com/blog/entry/60826">[Gym] The 2018 JUST Collegiate Programming Contest</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/hetp111" title="Pupil hetp111" class="rated-user user-green">hetp111</a>        
        <a href="https://codeforces.com/blog/entry/68754">Bug: Blank characters gives compilation error while copying code from submissions.</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/PikMike" title="International master PikMike" class="rated-user user-orange">PikMike</a>        
        <a href="https://codeforces.com/blog/entry/68615">Educational Codeforces Round 69 Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/anonymous1233" title="Unrated, anonymous1233" class="rated-user user-black">anonymous1233</a>        
        <a href="https://codeforces.com/blog/entry/68774">Help needed.</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a>        
        <a href="https://codeforces.com/blog/entry/68660">Call for problem setting on HackerEarth</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/pshishod2645" title="Candidate Master pshishod2645" class="rated-user user-violet">pshishod2645</a>        
        <a href="https://codeforces.com/blog/entry/68764">Linearity of Expectation : WTF</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/RPCLS_error" title="Newbie RPCLS_error" class="rated-user user-gray">RPCLS_error</a>        
        <a href="https://codeforces.com/blog/entry/68772">Merge sort any idea share .if needed that means easily implement when contest time  running,</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/DmitryGrigorev" title="International Grandmaster DmitryGrigorev" class="rated-user user-red">DmitryGrigorev</a>        
        <a href="https://codeforces.com/blog/entry/67891">Editorial of Round #569</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/mridul1809" title="Expert mridul1809" class="rated-user user-blue">mridul1809</a>        
        <a href="https://codeforces.com/blog/entry/67114">Template for Matrices</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="./ceoi-day2_files/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/kirito_" title="Specialist kirito_" class="rated-user user-cyan">kirito_</a>        
        <a href="https://codeforces.com/blog/entry/68769">Group Practice for Newbies or anybody else who wants to join!</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="./ceoi-day2_files/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="https://codeforces.com/profile/low_" title="Master low_" class="rated-user user-orange">low_</a>        
        <a href="https://codeforces.com/blog/entry/68563">First season HNOI Civil War conclusion</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="./ceoi-day2_files/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
            </ul>
        </div>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="https://codeforces.com/recent-actions">Detailed </a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>
</div>
                        <div id="pageContent" class="content-with-sidebar">
                    <div class="second-level-menu">
<ul class="second-level-menu-list"><li class="backLava" style="position: absolute; display: block; margin: 0px; padding: 0px; left: 39.6875px; top: 0px; width: 38px; height: 20px; overflow: hidden;"><div class="leftLava"></div><div class="bottomLava"></div><div class="cornerLava"></div></li>
        <li><a href="https://codeforces.com/profile/majk">majk</a></li>
        <li class="current selectedLava"><a href="https://codeforces.com/blog/majk">Blog</a></li>
        <li><a href="https://codeforces.com/teams/with/majk">Teams</a></li>
        <li><a href="https://codeforces.com/submissions/majk">Submissions</a></li>
        <li><a href="https://codeforces.com/contests/with/majk">Contests</a></li>
        <li><a href="https://codeforces.com/contests/writer/majk">Problemsetting</a></li>
</ul>
</div>
    <div style="margin-top:0;">
    <div>
        <h3><a href="https://codeforces.com/blog/majk" style="text-decoration:none;color:black !important;">majk's blog</a></h3>
    </div>
        <div style="margin-top:2em;">


<div class="topic" topicid="69219">
    <div class="title">
            <a href="https://codeforces.com/blog/entry/68748">            <p>CEOI 2019 Mirror Day 2</p>
</a>
    </div>

    <div class="info" style="position:relative;">
            By&nbsp;<a href="https://codeforces.com/profile/majk" title="International Grandmaster majk" class="rated-user user-red">majk</a>,
                <span class="format-humantime" title="Jul/27/2019 19:53 UTC-7">40 hours ago</span>,
            
            <img style="position: relative;top: 5px;" src="./ceoi-day2_files/gb.png" alt="In English" title="In English">,

<a class="attach-blogEntry-68748-to-contest-link" href="https://codeforces.com/blog/entry/68748#"><img src="./ceoi-day2_files/paperclip-16x16.png" title="Attach this blog to some contest as a resource"></a>

<style type="text/css">
    .attach-blogEntry-68748-to-contest-form tr:not(:last-of-type) td {
        padding-bottom: 1em;
    }

    .blogEntry-68748-error {
        font-size: 1.1rem;
    }
</style>

<div class="attach-blogEntry-68748-to-contest-form-holder" style="display: none;padding: 1em;margin: 1em;">
    <form class="attach-blogEntry-68748-to-contest-form" method="post"><input type="hidden" name="csrf_token" value="a400a051aa98a0c1e1e5c21297bdc579">
        <table style="width: 100%;">
            <thead>
            </thead>
            <tbody>
        <tr class="subscription-row blogEntry-68748-blogId-error blogEntry-68748-error" style="display: none;">
            <td>&nbsp;</td>
        <td colspan="2"><div class="shiftUp">        <span class="error for__blogEntry-68748-blogId">-</span>
</div></td>
        </tr>
            <tr>
                <td style="width: 30%;"><label for="blogEntry-68748-contestId">Contest:</label></td>
                <td>
                    <input type="text" style="width: 100%;float: left;" id="blogEntry-68748-contestId" name="contestIdAndName">
                </td>
                <td>
                </td>
            </tr>
        <tr class="subscription-row blogEntry-68748-contestId-error blogEntry-68748-error" style="display: none;">
            <td>&nbsp;</td>
        <td colspan="2"><div class="shiftUp">        <span class="error for__blogEntry-68748-contestId">-</span>
</div></td>
        </tr>
            <tr>
                <td style="width: 30%;"><label for="blogEntry-68748-resourceType">Type:</label></td>
                <td>
                    <select id="blogEntry-68748-resourceType" name="resourceType" style="width: 100%;">
                        <option value="" selected=""></option>
                        <option value="STATEMENT">statements</option>
                        <option value="TUTORIAL">tutorial</option>
                        <option value="ANNOUNCEMENT">announcement</option>
                        <option value="DISCUSSION">discussion</option>
                    </select>
                </td>
                <td></td>
            </tr>
        <tr class="subscription-row blogEntry-68748-resourceType-error blogEntry-68748-error" style="display: none;">
            <td>&nbsp;</td>
        <td colspan="2"><div class="shiftUp">        <span class="error for__blogEntry-68748-resourceType">-</span>
</div></td>
        </tr>
            <tr>
                <td colspan="2" style="text-align: center;">
                    <input type="submit" id="blogEntry-68748-resource-submit" value="Attach" style="padding: 0.25em 0.5em;margin: 1em;width: 8em;">
                </td>
                <td>
                    <img id="blogEntry-68748-resource-submitting-indicator" src="./ceoi-day2_files/indicator.gif" style="display: none;">
                </td>
            </tr>
            </tbody>
        </table>
    <input type="hidden" name="_tta" value="187"></form>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        $(".blogEntry-68748-error").hide();

        $(".attach-blogEntry-68748-to-contest-link").click(function () {
            Codeforces.facebox(".attach-blogEntry-68748-to-contest-form-holder", "//sta.codeforces.com/s/16651");

            var popupContestInput = $("#facebox input[name=contestIdAndName]");
            popupContestInput.autocomplete("/data/contests?action=suggestContestWithEditableResources", {
                delay: 200,
                width: 500,
                selectFirst: false,
                matchContains: true,
                scroll: true,
                max: 150,
                minChars: 2
            });

            $("#facebox .attach-blogEntry-68748-to-contest-form").submit(function () {
                var contestId = popupContestInput.attr("value").trim().split(/[\- ]/)[0];
                if (contestId !== undefined) {
                    $("#facebox .blogEntry-68748-error").hide();
                    $("#facebox #blogEntry-68748-resource-submitting-indicator").show();
                    $("#facebox #blogEntry-68748-resource-submit").attr("disabled", "disabled");

                    //noinspection JSUnusedGlobalSymbols
                    $.post("/data/blogAndContest?action=attachBlogToContest", {
                        blogId:"65009", contestId:contestId,
                        blogEntryId:"68748",
                        resourceType:$("#facebox #blogEntry-68748-resourceType").val()
                    }, function (json) {
                        var validated = true;

                        for (var key in json) {
                            if (json.hasOwnProperty(key) && key.indexOf("error__") === 0) {
                                validated = false;
                                $("#facebox .blogEntry-68748-" + key.substring("error__".length) + "-error").show();
                                $("#facebox .for__blogEntry-68748-" + key.substring("error__".length)).text(json[key]);
                            }
                        }

                        $("#facebox #blogEntry-68748-resource-submitting-indicator").hide();
                        $("#facebox #blogEntry-68748-resource-submit").removeAttr("disabled");

                        if (validated) {
                            $.facebox.close();
                            if (json["success"] === "true") {
                                Codeforces.showMessage("Blog has been successfully attached to selected contest");
                            } else {
                                Codeforces.showMessage("There is unexpected error while attaching blog to the contest");
                            }
                        }
                    }, "json");
                }

                return false;
            });


            return false;
        });
    });
</script>



        <span style="position:absolute;right:0;top:0.05em;margin-right:1em;display:inline;font-size:0.75em;">
            <div style="margin-top:0.25em;">
            </div>
        </span>
    </div>

    <div class="content">
        <div class="ttypography"><div><h3><a href="https://codeforces.com/contest/1193/problem/A" title="CEOI 2019 day 2 online mirror (unrated, IOI format)">1193A - Amusement Park</a></h3><div class="ttypography"><div class="problem-statement"><div><p><span class="tex-font-style-bf">Subtask 1</span></p><p>There are only five non-isomorphic directed graphs on at most three vertices (ignoring the isolated vertices), and the answer can be simply computed by hand.</p><p><span class="tex-font-style-bf">Subtask 2</span></p><p>As <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mstyle scriptlevel=&quot;0&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mstyle scriptlevel=&quot;0&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 6.853em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.624em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.052em, 1005.51em, 3.75em, -999.997em); top: -3.159em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-4" style="font-family: STIXGeneral; padding-left: 0.296em;"></span><span class="texatom" id="MathJax-Span-5" style="padding-left: 0.296em;"><span class="mrow" id="MathJax-Span-6"><span class="mrow" id="MathJax-Span-7"><span class="TeXmathchoice" id="MathJax-Span-8"><span class="mstyle" id="MathJax-Span-9"><span class="mrow" id="MathJax-Span-10"><span class="texatom" id="MathJax-Span-11"><span class="mrow" id="MathJax-Span-12"><span class="mo" id="MathJax-Span-13" style="vertical-align: -0.231em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">(</span></span></span></span></span></span></span></span><span class="mfrac" id="MathJax-Span-14"><span style="display: inline-block; position: relative; width: 0.354em; height: 0px;"><span style="position: absolute; clip: rect(3.34em, 1000.3em, 4.16em, -999.997em); top: -4.447em; left: 50%; margin-left: -0.173em;"><span class="mn" id="MathJax-Span-15" style="font-size: 70.7%; font-family: STIXGeneral;">7</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.34em, 1000.35em, 4.16em, -999.997em); top: -3.627em; left: 50%; margin-left: -0.173em;"><span class="mn" id="MathJax-Span-16" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-17"><span class="mstyle" id="MathJax-Span-18"><span class="mrow" id="MathJax-Span-19"><span class="texatom" id="MathJax-Span-20"><span class="mrow" id="MathJax-Span-21"><span class="mo" id="MathJax-Span-22" style="vertical-align: -0.231em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">)</span></span></span></span></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-23" style="font-family: STIXGeneral; padding-left: 0.296em;">=</span><span class="mn" id="MathJax-Span-24" style="font-family: STIXGeneral; padding-left: 0.296em;">21</span></span><span style="display: inline-block; width: 0px; height: 3.165em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mo></mo><mrow class="MJX-TeXAtom-ORD"><mrow><mstyle scriptlevel="0"><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">(</mo></mrow></mstyle><mfrac linethickness="0"><mn>7</mn><mn>2</mn></mfrac><mstyle scriptlevel="0"><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">)</mo></mrow></mstyle></mrow></mrow><mo>=</mo><mn>21</mn></math></span></span><script type="math/tex" id="MathJax-Element-1">m \leq {7 \choose 2} = 21</script>, we can enumerate all <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-25" style="width: 1.291em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.291em, 1001.06em, 2.345em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-26"><span class="msubsup" id="MathJax-Span-27"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px;"><span style="position: absolute; clip: rect(3.106em, 1000.47em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mn" id="MathJax-Span-28" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.53em;"><span class="mi" id="MathJax-Span-29" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>m</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-2">2^m</script> reorientations, check whether they are acyclic and sum their cost. Time complexity is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-30" style="width: 6.736em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.506em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.111em, 1005.45em, 3.34em, -999.997em); top: -2.983em; left: 0em;"><span class="mrow" id="MathJax-Span-31"><span class="texatom" id="MathJax-Span-32"><span class="mrow" id="MathJax-Span-33"><span class="mi" id="MathJax-Span-34" style="font-family: STIXNonUnicode; font-style: italic;"></span></span></span><span class="mo" id="MathJax-Span-35" style="font-family: STIXGeneral;">(</span><span class="mo" id="MathJax-Span-36" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-37" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-38" style="font-family: STIXGeneral; padding-left: 0.237em;">+</span><span class="mi" id="MathJax-Span-39" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.237em;"></span><span class="mo" id="MathJax-Span-40" style="font-family: STIXGeneral;">)</span><span class="msubsup" id="MathJax-Span-41"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px;"><span style="position: absolute; clip: rect(3.106em, 1000.47em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mn" id="MathJax-Span-42" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.53em;"><span class="mi" id="MathJax-Span-43" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-44" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.989em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo><msup><mn>2</mn><mi>m</mi></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3">\mathcal O((n+m) 2^m)</script>.</p><p><span class="tex-font-style-bf">Subtask 3</span></p><p>Consider a permutation of vertices <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-45" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.71em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-46"><span class="mi" id="MathJax-Span-47" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">P</script>. This permutation is a valid topological order in some reorientation of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-48" style="width: 0.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.764em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.76em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-49"><span class="mi" id="MathJax-Span-50" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">G</script>. However, there may be multiple topological orders of the same graph. We can enumerate all <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-51" style="width: 1.525em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1001.12em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-52"><span class="mi" id="MathJax-Span-53" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-54" style="font-family: STIXGeneral;">!</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo>!</mo></math></span></span><script type="math/tex" id="MathJax-Element-6">N!</script> permutations, and sum the cost of all distinct reorientations - each one is represented as a bitmask of flipped edges, and those are put into set. There are at most <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;45&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-55" style="width: 1.232em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.998em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1000.94em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-56"><span class="mn" id="MathJax-Span-57" style="font-family: STIXGeneral;">45</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>45</mn></math></span></span><script type="math/tex" id="MathJax-Element-7">45</script> edges, so <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;64&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-58" style="width: 1.232em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.998em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1001em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-59"><span class="mn" id="MathJax-Span-60" style="font-family: STIXGeneral;">64</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>64</mn></math></span></span><script type="math/tex" id="MathJax-Element-8">64</script>-bit integer is sufficient and easy to implement option, where <span class="tex-font-style-tt">__builtin_popcountll</span> returns the cost the reorientation. Time complexity is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-61" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.93em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1002.87em, 2.872em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-62"><span class="mi" id="MathJax-Span-63" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-64" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-65" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-66" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-67" style="font-family: STIXGeneral;">!</span><span class="mo" id="MathJax-Span-68" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mi>n</mi><mo>!</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-9">O(m n!)</script></p><p><span class="tex-font-style-bf">Subtask 4</span></p><p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-69" style="width: 2.872em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.345em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.111em, 1002.29em, 3.34em, -999.997em); top: -2.983em; left: 0em;"><span class="mrow" id="MathJax-Span-70"><span class="texatom" id="MathJax-Span-71"><span class="mrow" id="MathJax-Span-72"><span class="mi" id="MathJax-Span-73" style="font-family: STIXNonUnicode; font-style: italic;"></span></span></span><span class="mo" id="MathJax-Span-74" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-75"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.106em, 1000.47em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mn" id="MathJax-Span-76" style="font-family: STIXGeneral;">4</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.53em;"><span class="mi" id="MathJax-Span-77" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-78" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.989em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><msup><mn>4</mn><mi>n</mi></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-10">\mathcal O(4^n)</script> solution. Will be described later.</p><p><span class="tex-font-style-bf">Subtask 5</span></p><p>Let's first solve the problem of counting the number of acyclic reorientations using the topological orders as outlined in the previous subtask. Recall Kahn's algorithm for finding topological ordering: while there are vertices in the graph, pick a vertex with in-degree <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-79" style="width: 0.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1000.53em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-80"><span class="mn" id="MathJax-Span-81" style="font-family: STIXGeneral;">0</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-11">0</script> and remove it along with all incident arcs. With proper bookkeeping, this can be implemented in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-82" style="width: 4.57em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.75em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.111em, 1003.69em, 3.34em, -999.997em); top: -2.983em; left: 0em;"><span class="mrow" id="MathJax-Span-83"><span class="texatom" id="MathJax-Span-84"><span class="mrow" id="MathJax-Span-85"><span class="mi" id="MathJax-Span-86" style="font-family: STIXNonUnicode; font-style: italic;"></span></span></span><span class="mo" id="MathJax-Span-87" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-88" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-89" style="font-family: STIXGeneral; padding-left: 0.237em;">+</span><span class="mi" id="MathJax-Span-90" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.237em;"></span><span class="mo" id="MathJax-Span-91" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.989em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-12">\mathcal O(n + m)</script>.</p><p>We will consider only certain topological orders called <span class="tex-font-style-it">canonical</span>. We call a topological order canonical, if at every step of Kahn's algorithm the available vertex with the smallest index is picked. Clearly, each acyclic graph has exactly one canonical topological order, so we can restrict ourselves to counting those.</p><p>We will use the following dynamic programming approach - let <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-92" style="width: 4.335em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.516em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1003.4em, 2.872em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-93"><span class="mi" id="MathJax-Span-94" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-95" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-96" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-97" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-98" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-99" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-100" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi><mo stretchy="false">[</mo><mi>A</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>B</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-13">D[A][B]</script> be the number of ways of permuting the vertices of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-101" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.65em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-102"><span class="mi" id="MathJax-Span-103" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">A</script>, such that this order is a prefix of some canonical topological order, and the set of vertices that can have zero indegree equals to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-104" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.71em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-105"><span class="mi" id="MathJax-Span-106" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">B</script>. The transition from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-107" style="width: 4.335em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.516em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1003.4em, 2.872em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-108"><span class="mi" id="MathJax-Span-109" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-110" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-111" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-112" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-113" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-114" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-115" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi><mo stretchy="false">[</mo><mi>A</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>B</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-16">D[A][B]</script> consists of trying all possible choices of vertex c from the set <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-116" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.71em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-117"><span class="mi" id="MathJax-Span-118" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-17">B</script> to be the next vertex in the canonical topological order. To which state <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-119" style="width: 5.097em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.16em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.584em, 1004.04em, 2.872em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-120"><span class="mi" id="MathJax-Span-121" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-122" style="font-family: STIXGeneral;">[</span><span class="msup" id="MathJax-Span-123"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-124" style="font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.33em; left: 0.706em;"><span class="mo" id="MathJax-Span-125" style="font-size: 70.7%; font-family: STIXVariants;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-126" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-127" style="font-family: STIXGeneral;">[</span><span class="msup" id="MathJax-Span-128"><span style="display: inline-block; position: relative; width: 0.998em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-129" style="font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.33em; left: 0.706em;"><span class="mo" id="MathJax-Span-130" style="font-size: 70.7%; font-family: STIXVariants;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-131" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi><mo stretchy="false">[</mo><msup><mi>A</mi><mo></mo></msup><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msup><mi>B</mi><mo></mo></msup><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-18">D[A'][B']</script> do we transition?</p><p>The case of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-132" style="width: 1.291em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1001.06em, 2.345em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-133"><span class="msup" id="MathJax-Span-134"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-135" style="font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.33em; left: 0.706em;"><span class="mo" id="MathJax-Span-136" style="font-size: 70.7%; font-family: STIXVariants;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mo></mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-19">A'</script> is simple: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x222A;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-137" style="width: 7.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.799em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.584em, 1005.68em, 2.872em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-138"><span class="msup" id="MathJax-Span-139"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-140" style="font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.33em; left: 0.706em;"><span class="mo" id="MathJax-Span-141" style="font-size: 70.7%; font-family: STIXVariants;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-142" style="font-family: STIXGeneral; padding-left: 0.296em;">:<span style="font-family: STIXGeneral; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-143" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.296em;"></span><span class="mo" id="MathJax-Span-144" style="font-family: STIXGeneral; padding-left: 0.237em;"></span><span class="mo" id="MathJax-Span-145" style="font-family: STIXGeneral; padding-left: 0.237em;">{</span><span class="mi" id="MathJax-Span-146" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-147" style="font-family: STIXGeneral;">}</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mo></mo></msup><mo>:=</mo><mi>A</mi><mo></mo><mo fence="false" stretchy="false">{</mo><mi>c</mi><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-20">A' := A \cup \{c\}</script></p><p>What happens to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-148" style="width: 1.232em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.998em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1001em, 2.345em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-149"><span class="msup" id="MathJax-Span-150"><span style="display: inline-block; position: relative; width: 0.998em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-151" style="font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.33em; left: 0.706em;"><span class="mo" id="MathJax-Span-152" style="font-size: 70.7%; font-family: STIXVariants;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>B</mi><mo></mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-21">B'</script>? All vertices with smaller index than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-153" style="width: 0.53em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.413em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.41em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-154"><span class="mi" id="MathJax-Span-155" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">c</script> clearly can't have indegree zero anymore, as otherwise we would not have picked <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-156" style="width: 0.53em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.413em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.41em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-157"><span class="mi" id="MathJax-Span-158" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">c</script>. However, we must also remove all outgoing edges from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-159" style="width: 0.53em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.413em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.41em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-160"><span class="mi" id="MathJax-Span-161" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-24">c</script>. To do this, observe that all neighbours of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-162" style="width: 0.53em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.413em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.41em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-163"><span class="mi" id="MathJax-Span-164" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">c</script> that are not already in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-165" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.65em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-166"><span class="mi" id="MathJax-Span-167" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-26">A</script> get their indegree decreased. In particular, it may become zero, so the vertex is added to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-168" style="width: 1.232em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.998em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1001em, 2.345em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-169"><span class="msup" id="MathJax-Span-170"><span style="display: inline-block; position: relative; width: 0.998em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-171" style="font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.33em; left: 0.706em;"><span class="mo" id="MathJax-Span-172" style="font-size: 70.7%; font-family: STIXVariants;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>B</mi><mo></mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-27">B'</script>:</p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo class=&quot;MJX-variant&quot;&gt;&amp;#x2216;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x222A;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo class=&quot;MJX-variant&quot;&gt;&amp;#x2216;&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-173" style="width: 20.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.923em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.525em, 1016.87em, 2.93em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-174"><span class="msup" id="MathJax-Span-175"><span style="display: inline-block; position: relative; width: 0.998em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-176" style="font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.706em;"><span class="mo" id="MathJax-Span-177" style="font-size: 70.7%; font-family: STIXVariants;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-178" style="font-family: STIXGeneral; padding-left: 0.296em;">:<span style="font-family: STIXGeneral; font-style: normal; font-weight: normal;">=</span></span><span class="mo" id="MathJax-Span-179" style="font-family: STIXGeneral; padding-left: 0.296em;">(</span><span class="mi" id="MathJax-Span-180" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-181" style="font-family: STIXVariants; padding-left: 0.237em;"></span><span class="mo" id="MathJax-Span-182" style="font-family: STIXGeneral; padding-left: 0.237em;">{</span><span class="mn" id="MathJax-Span-183" style="font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-184" style="font-family: STIXGeneral;">,</span><span class="mn" id="MathJax-Span-185" style="font-family: STIXGeneral; padding-left: 0.179em;">1</span><span class="mo" id="MathJax-Span-186" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-187" style="font-family: STIXGeneral; padding-left: 0.179em;">.</span><span class="mo" id="MathJax-Span-188" style="font-family: STIXGeneral; padding-left: 0.179em;">.</span><span class="mo" id="MathJax-Span-189" style="font-family: STIXGeneral; padding-left: 0.179em;">.</span><span class="mo" id="MathJax-Span-190" style="font-family: STIXGeneral; padding-left: 0.179em;">,</span><span class="mi" id="MathJax-Span-191" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.179em;"></span><span class="mo" id="MathJax-Span-192" style="font-family: STIXGeneral; padding-left: 0.237em;"></span><span class="mn" id="MathJax-Span-193" style="font-family: STIXGeneral; padding-left: 0.237em;">1</span><span class="mo" id="MathJax-Span-194" style="font-family: STIXGeneral;">}</span><span class="mo" id="MathJax-Span-195" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-196" style="font-family: STIXGeneral; padding-left: 0.237em;"></span><span class="mo" id="MathJax-Span-197" style="font-family: STIXGeneral; padding-left: 0.237em;">(</span><span class="mi" id="MathJax-Span-198" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-199" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-200" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-201" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-202" style="font-family: STIXVariants; padding-left: 0.237em;"></span><span class="mi" id="MathJax-Span-203" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.237em;"></span><span class="mo" id="MathJax-Span-204" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>B</mi><mo></mo></msup><mo>:=</mo><mo stretchy="false">(</mo><mi>B</mi><mo class="MJX-variant"></mo><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><mi>c</mi><mo></mo><mn>1</mn><mo fence="false" stretchy="false">}</mo><mo stretchy="false">)</mo><mo></mo><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mo class="MJX-variant"></mo><mi>A</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-28">B' := (B \setminus \{0,1,...,c-1\}) \cup (N(c) \setminus A)</script></p><p>where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-205" style="width: 2.462em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.994em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1001.93em, 2.872em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-206"><span class="mi" id="MathJax-Span-207" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-208" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-209" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-210" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-29">N(c)</script> is the set of neighbours of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-211" style="width: 0.53em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.413em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.41em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-212"><span class="mi" id="MathJax-Span-213" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">c</script>.</p><p>How to sum the costs of the reorientations? We maintain a second DP table <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-214" style="width: 3.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.047em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1002.93em, 2.872em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-215"><span class="mi" id="MathJax-Span-216" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-217" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-218" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-219" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-220" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-221" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-222" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo stretchy="false">[</mo><mi>a</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>b</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-31">C[a][b]</script>. When picking a vertex v, we have to flip all outgoing arcs with their endpoint in A. In other words </p><p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-223" style="width: 24.71em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.261em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.525em, 1020.14em, 2.872em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-224"><span class="mi" id="MathJax-Span-225" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-226" style="font-family: STIXGeneral;">[</span><span class="msup" id="MathJax-Span-227"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-228" style="font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.706em;"><span class="mo" id="MathJax-Span-229" style="font-size: 70.7%; font-family: STIXVariants;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-230" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-231" style="font-family: STIXGeneral;">[</span><span class="msup" id="MathJax-Span-232"><span style="display: inline-block; position: relative; width: 0.998em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-233" style="font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.706em;"><span class="mo" id="MathJax-Span-234" style="font-size: 70.7%; font-family: STIXVariants;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-235" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-236" style="font-family: STIXGeneral;">+</span><span class="mo" id="MathJax-Span-237" style="font-family: STIXGeneral; padding-left: 0.296em;">=</span><span class="mi" id="MathJax-Span-238" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.296em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-239" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-240" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-241" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-242" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-243" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-244" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-245" style="font-family: STIXGeneral; padding-left: 0.237em;">+</span><span class="mi" id="MathJax-Span-246" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.237em;"></span><span class="mo" id="MathJax-Span-247" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-248" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-249" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-250" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-251" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-252" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-253" style="font-family: STIXGeneral; padding-left: 0.237em;"></span><span class="texatom" id="MathJax-Span-254" style="padding-left: 0.237em;"><span class="mrow" id="MathJax-Span-255"><span class="mo" id="MathJax-Span-256" style="font-family: STIXVariants;">|</span></span></span><span class="msubsup" id="MathJax-Span-257"><span style="display: inline-block; position: relative; width: 1.525em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.88em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-258" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.94em;"><span class="texatom" id="MathJax-Span-259"><span class="mrow" id="MathJax-Span-260"><span class="mo" id="MathJax-Span-261" style="font-size: 70.7%; font-family: STIXGeneral;">+</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-262" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-263" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-264" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-265" style="font-family: STIXGeneral; padding-left: 0.237em;"></span><span class="mi" id="MathJax-Span-266" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.237em;"></span><span class="texatom" id="MathJax-Span-267"><span class="mrow" id="MathJax-Span-268"><span class="mo" id="MathJax-Span-269" style="font-family: STIXVariants;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>C</mi><mo stretchy="false">[</mo><msup><mi>A</mi><mo></mo></msup><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msup><mi>B</mi><mo></mo></msup><mo stretchy="false">]</mo><mo>+</mo><mo>=</mo><mi>C</mi><mo stretchy="false">[</mo><mi>A</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>B</mi><mo stretchy="false">]</mo><mo>+</mo><mi>D</mi><mo stretchy="false">[</mo><mi>A</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>B</mi><mo stretchy="false">]</mo><mo></mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msup><mi>N</mi><mrow class="MJX-TeXAtom-ORD"><mo>+</mo></mrow></msup><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mo></mo><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-32">C[A'][B'] += C[A][B] + D[A][B] * |N^{+}(c) \cap A|</script></p><p>where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-270" style="width: 3.165em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.579em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.584em, 1002.52em, 2.872em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-271"><span class="msubsup" id="MathJax-Span-272"><span style="display: inline-block; position: relative; width: 1.525em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.88em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-273" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.33em; left: 0.94em;"><span class="texatom" id="MathJax-Span-274"><span class="mrow" id="MathJax-Span-275"><span class="mo" id="MathJax-Span-276" style="font-size: 70.7%; font-family: STIXGeneral;">+</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-277" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-278" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-279" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>N</mi><mrow class="MJX-TeXAtom-ORD"><mo>+</mo></mrow></msup><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-33">N^{+}(c)</script> is the set of vertices to which there is an arc from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-280" style="width: 0.53em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.413em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.41em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-281"><span class="mi" id="MathJax-Span-282" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">c</script> in graph <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-283" style="width: 0.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.764em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.76em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-284"><span class="mi" id="MathJax-Span-285" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">G</script>.</p><p>Alternatively, we can observe that for each acyclic reorientation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-286" style="width: 1.174em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.94em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-287"><span class="mi" id="MathJax-Span-288" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">H</script> the reverse orientation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-289" style="width: 1.935em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.584em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.174em, 1001.58em, 2.345em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-290"><span class="msubsup" id="MathJax-Span-291"><span style="display: inline-block; position: relative; width: 1.584em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.94em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-292" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.33em; left: 0.998em;"><span class="mi" id="MathJax-Span-293" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>H</mi><mi>R</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-37">H^R</script> is also acyclic and the sum of costs of these two orientations is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-294" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.65em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-295"><span class="mi" id="MathJax-Span-296" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-38">m</script>. As a result, the answer is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-297" style="width: 5.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.394em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1004.39em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-298"><span class="mi" id="MathJax-Span-299" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-300" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-301" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-302" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-303" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-304" style="font-family: STIXGeneral; padding-left: 0.237em;"></span><span class="mi" id="MathJax-Span-305" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.237em;"></span><span class="texatom" id="MathJax-Span-306"><span class="mrow" id="MathJax-Span-307"><span class="mo" id="MathJax-Span-308" style="font-family: STIXGeneral;">/</span></span></span><span class="mn" id="MathJax-Span-309" style="font-family: STIXGeneral;">2</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo></mo><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-39">count \cdot m / 2</script>.</p><p>As <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-310" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.65em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-311"><span class="mi" id="MathJax-Span-312" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-40">A</script> is always disjoint with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-313" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.71em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-314"><span class="mi" id="MathJax-Span-315" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">B</script>, there are <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-316" style="width: 1.174em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.291em, 1000.94em, 2.345em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-317"><span class="msubsup" id="MathJax-Span-318"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.106em, 1000.41em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mn" id="MathJax-Span-319" style="font-family: STIXGeneral;">3</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.53em;"><span class="mi" id="MathJax-Span-320" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>3</mn><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-42">3^n</script> states and each state has at most n transitions. These can be performed using bitmasks, so the total runtime can be bounded from above by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;msup&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-321" style="width: 3.457em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.813em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1002.75em, 2.872em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-322"><span class="mi" id="MathJax-Span-323" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-324" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-325" style="font-family: STIXGeneral; font-style: italic;"></span><span class="msubsup" id="MathJax-Span-326"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.106em, 1000.41em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mn" id="MathJax-Span-327" style="font-family: STIXGeneral;">3</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.53em;"><span class="mi" id="MathJax-Span-328" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-329" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><msup><mn>3</mn><mi>n</mi></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-43">O(n 3^n)</script>.</p><p>A lot of states are in fact unreachable. Can you prove a tighter upper bound than the one we have shown?</p></div></div></div></div> <div><h3><a href="https://codeforces.com/contest/1193/problem/B" title="CEOI 2019 day 2 online mirror (unrated, IOI format)">1193B - Magic Tree</a></h3><div class="ttypography"><div class="problem-statement"><div><p>The first couple subtasks are meant as a reward for understanding the problem statement.</p><p>In the subtask 1, we can enumerate all subsets of fruit, decide whether this set is valid (i.e. it doesn't contain pair of fruits <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-330" style="width: 0.588em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.41em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-331"><span class="mi" id="MathJax-Span-332" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">u</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-333" style="width: 0.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.53em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-334"><span class="mi" id="MathJax-Span-335" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-45">v</script> such that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-336" style="width: 0.588em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.41em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-337"><span class="mi" id="MathJax-Span-338" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-46">u</script> is an ancestor of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-339" style="width: 0.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.53em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-340"><span class="mi" id="MathJax-Span-341" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">v</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-342" style="width: 0.588em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.41em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-343"><span class="mi" id="MathJax-Span-344" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-48">u</script> is ripe earlier than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-345" style="width: 0.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.53em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-346"><span class="mi" id="MathJax-Span-347" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-49">v</script>) and output the maximum.</p><p>If all fruit is in the leaves, all fruit can be harvested at proper times, so the answer is simply the total juiciness of all fruits.</p><p>In subtask 3, the problem formulated on a path is equivalent to finding the longest non-decreasing subsequence in the list of ripening times along the path. Using any <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-348" style="width: 4.921em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.043em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.111em, 1003.98em, 3.399em, -999.997em); top: -2.983em; left: 0em;"><span class="mrow" id="MathJax-Span-349"><span class="texatom" id="MathJax-Span-350"><span class="mrow" id="MathJax-Span-351"><span class="mi" id="MathJax-Span-352" style="font-family: STIXNonUnicode; font-style: italic;"></span></span></span><span class="mo" id="MathJax-Span-353" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-354" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-355" style="font-family: STIXGeneral; padding-left: 0.179em;">log</span><span class="mo" id="MathJax-Span-356"></span><span class="mi" id="MathJax-Span-357" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.179em;"></span><span class="mo" id="MathJax-Span-358" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.989em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo></mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-50">\mathcal O(n \log n)</script> solution gives the answer.</p><p>Not very surprisingly, on a tree the task can be solved by a dynamic programming approach by processing the tree upwards from leaves to the root. The scoring rewards different solutions of how information is stored, merged and propagated in the tree.</p><p>For the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-359" style="width: 3.047em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.462em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1002.4em, 2.872em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-360"><span class="mi" id="MathJax-Span-361" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-362" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-363" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-364" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-365" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>k</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-51">O(n k)</script> solution one calculates for each vertex <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-366" style="width: 0.588em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.41em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-367"><span class="mi" id="MathJax-Span-368" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-52">u</script> and number of days <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-369" style="width: 0.354em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.296em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.24em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-370"><span class="mi" id="MathJax-Span-371" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-53">i</script> the following quantity: <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;maximum total juiciness one can harvest from the subtree rooted at&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;during the first&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;days.&lt;/mtext&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-372" style="width: 48.305em; display: inline-block;"><span style="display: inline-block; position: relative; width: 39.581em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1039.52em, 2.93em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-373"><span class="msubsup" id="MathJax-Span-374"><span style="display: inline-block; position: relative; width: 1.701em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-375" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.647em;"><span class="texatom" id="MathJax-Span-376"><span class="mrow" id="MathJax-Span-377"><span class="mi" id="MathJax-Span-378" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-379" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-380" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-381" style="font-family: STIXGeneral; padding-left: 0.296em;">=</span><span class="mstyle" id="MathJax-Span-382" style="padding-left: 0.296em;"><span class="mrow" id="MathJax-Span-383"><span class="mtext" id="MathJax-Span-384" style="font-family: STIXGeneral;">maximum total juiciness one can harvest from the subtree rooted at&nbsp;</span><span class="texatom" id="MathJax-Span-385"><span class="mrow" id="MathJax-Span-386"><span class="mi" id="MathJax-Span-387" style="font-family: STIXGeneral; font-style: italic;"></span></span></span><span class="mtext" id="MathJax-Span-388" style="font-family: STIXGeneral;">&nbsp;during the first&nbsp;</span><span class="texatom" id="MathJax-Span-389"><span class="mrow" id="MathJax-Span-390"><span class="mi" id="MathJax-Span-391" style="font-family: STIXGeneral; font-style: italic;"></span></span></span><span class="mtext" id="MathJax-Span-392" style="font-family: STIXGeneral;">&nbsp;days.</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>v</mi><mo>,</mo><mi></mi></mrow></msub><mo>=</mo><mstyle displaystyle="false" scriptlevel="0"><mtext>maximum total juiciness one can harvest from the subtree rooted at&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mi>v</mi></mrow><mtext>&nbsp;during the first&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow><mtext>&nbsp;days.</mtext></mstyle></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-54">C_{v, \ell} = \mbox{maximum total juiciness one can harvest from the subtree rooted at $v$ during the first $i$ days.}</script> The transition for parent <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-393" style="width: 0.588em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.41em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-394"><span class="mi" id="MathJax-Span-395" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-55">u</script> and children <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-396" style="width: 0.998em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.823em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.525em, 1000.82em, 2.52em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-397"><span class="msubsup" id="MathJax-Span-398"><span style="display: inline-block; position: relative; width: 0.823em; height: 0px;"><span style="position: absolute; clip: rect(3.34em, 1000.47em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-399" style="font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.53em;"><span class="mi" id="MathJax-Span-400" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-56">v_i</script> is <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-401" style="width: 7.673em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.268em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.35em, 1006.27em, 4.043em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-402"><span class="msubsup" id="MathJax-Span-403"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-404" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.399em, 1000.3em, 4.16em, -999.997em); top: -4.33em; left: 0.764em;"><span class="mo" id="MathJax-Span-405" style="font-size: 70.7%; font-family: STIXVariants;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.34em, 1001em, 4.277em, -999.997em); top: -3.686em; left: 0.647em;"><span class="texatom" id="MathJax-Span-406"><span class="mrow" id="MathJax-Span-407"><span class="mi" id="MathJax-Span-408" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-409" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-410" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-411" style="font-family: STIXGeneral; padding-left: 0.296em;">=</span><span class="munderover" id="MathJax-Span-412" style="padding-left: 0.296em;"><span style="display: inline-block; position: relative; width: 1.291em; height: 0px;"><span style="position: absolute; clip: rect(2.813em, 1001.23em, 4.628em, -999.997em); top: -3.978em; left: 0em;"><span class="mo" id="MathJax-Span-413" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.457em, 1000.59em, 4.394em, -999.997em); top: -2.807em; left: 0.354em;"><span class="texatom" id="MathJax-Span-414"><span class="mrow" id="MathJax-Span-415"><span class="msubsup" id="MathJax-Span-416"><span style="display: inline-block; position: relative; width: 0.588em; height: 0px;"><span style="position: absolute; clip: rect(3.457em, 1000.35em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-417" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.354em;"><span class="mi" id="MathJax-Span-418" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-419" style="padding-left: 0.179em;"><span style="display: inline-block; position: relative; width: 1.876em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-420" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.647em;"><span class="texatom" id="MathJax-Span-421"><span class="mrow" id="MathJax-Span-422"><span class="msubsup" id="MathJax-Span-423"><span style="display: inline-block; position: relative; width: 0.588em; height: 0px;"><span style="position: absolute; clip: rect(3.457em, 1000.35em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-424" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.354em;"><span class="mi" id="MathJax-Span-425" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-426" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-427" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.711em; border-left: 0px solid; width: 0px; height: 3.004em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msubsup><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>u</mi><mo>,</mo><mi></mi></mrow><mo></mo></msubsup><mo>=</mo><munder><mo></mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>v</mi><mi>i</mi></msub></mrow></munder><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>v</mi><mi>i</mi></msub><mo>,</mo><mi></mi></mrow></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-57">C'_{u, \ell} = \sum_{v_i} C_{v_i, \ell}</script> <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;mtext&gt;if fruit in&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;is ripe at&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;otherwise&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-428" style="width: 30.682em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.12em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.345em, 1025.12em, 5.389em, -999.997em); top: -4.095em; left: 0em;"><span class="mrow" id="MathJax-Span-429"><span class="msubsup" id="MathJax-Span-430"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-431" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.647em;"><span class="texatom" id="MathJax-Span-432"><span class="mrow" id="MathJax-Span-433"><span class="mi" id="MathJax-Span-434" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-435" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-436" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-437" style="font-family: STIXGeneral; padding-left: 0.296em;">=</span><span class="mrow" id="MathJax-Span-438" style="padding-left: 0.296em;"><span class="mo" id="MathJax-Span-439" style="vertical-align: -0.583em;"><span style="font-family: STIXSizeThreeSym;">{</span></span><span class="mtable" id="MathJax-Span-440"><span style="display: inline-block; position: relative; width: 20.963em; height: 0px; margin-right: 0.179em; margin-left: 0.179em;"><span style="position: absolute; clip: rect(2.286em, 1008.73em, 5.272em, -999.997em); top: -3.978em; left: 0em;"><span style="display: inline-block; position: relative; width: 8.727em; height: 0px;"><span style="position: absolute; clip: rect(3.106em, 1008.73em, 4.57em, -999.997em); top: -4.739em; left: 0em;"><span class="mtd" id="MathJax-Span-441"><span class="mrow" id="MathJax-Span-442"><span class="mo" id="MathJax-Span-443" style="font-family: STIXGeneral;">max</span><span class="mo" id="MathJax-Span-444" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-445"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-446" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.399em, 1000.3em, 4.16em, -999.997em); top: -4.33em; left: 0.764em;"><span class="mo" id="MathJax-Span-447" style="font-size: 70.7%; font-family: STIXVariants;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.34em, 1001em, 4.277em, -999.997em); top: -3.686em; left: 0.647em;"><span class="texatom" id="MathJax-Span-448"><span class="mrow" id="MathJax-Span-449"><span class="mi" id="MathJax-Span-450" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-451" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-452" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-453" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-454" style="padding-left: 0.179em;"><span style="display: inline-block; position: relative; width: 1.174em; height: 0px;"><span style="position: absolute; clip: rect(3.34em, 1000.76em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-455" style="font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.764em;"><span class="mi" id="MathJax-Span-456" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-457" style="font-family: STIXGeneral; padding-left: 0.237em;">+</span><span class="msubsup" id="MathJax-Span-458" style="padding-left: 0.237em;"><span style="display: inline-block; position: relative; width: 1.935em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-459" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.399em, 1000.3em, 4.16em, -999.997em); top: -4.33em; left: 0.764em;"><span class="mo" id="MathJax-Span-460" style="font-size: 70.7%; font-family: STIXVariants;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.34em, 1001.23em, 4.277em, -999.997em); top: -3.686em; left: 0.647em;"><span class="texatom" id="MathJax-Span-461"><span class="mrow" id="MathJax-Span-462"><span class="mi" id="MathJax-Span-463" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-464" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-465"><span style="display: inline-block; position: relative; width: 0.647em; height: 0px;"><span style="position: absolute; clip: rect(3.34em, 1000.35em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-466" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.354em;"><span class="mi" id="MathJax-Span-467" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-468" style="font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.106em, 1001.64em, 4.57em, -999.997em); top: -3.334em; left: 0em;"><span class="mtd" id="MathJax-Span-484"><span class="mrow" id="MathJax-Span-485"><span class="msubsup" id="MathJax-Span-486"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-487" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.399em, 1000.3em, 4.16em, -999.997em); top: -4.33em; left: 0.764em;"><span class="mo" id="MathJax-Span-488" style="font-size: 70.7%; font-family: STIXVariants;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.34em, 1001em, 4.277em, -999.997em); top: -3.686em; left: 0.647em;"><span class="texatom" id="MathJax-Span-489"><span class="mrow" id="MathJax-Span-490"><span class="mi" id="MathJax-Span-491" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-492" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-493" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.345em, 1011.07em, 4.862em, -999.997em); top: -3.978em; left: 9.898em;"><span style="display: inline-block; position: relative; width: 11.069em; height: 0px;"><span style="position: absolute; clip: rect(3.106em, 1011.07em, 4.394em, -999.997em); top: -4.739em; left: 0em;"><span class="mtd" id="MathJax-Span-469"><span class="mrow" id="MathJax-Span-470"><span class="mrow" id="MathJax-Span-471"><span class="mtext" id="MathJax-Span-472" style="font-family: STIXGeneral;">if fruit in&nbsp;</span><span class="texatom" id="MathJax-Span-473"><span class="mrow" id="MathJax-Span-474"><span class="mi" id="MathJax-Span-475" style="font-family: STIXGeneral; font-style: italic;"></span></span></span><span class="mtext" id="MathJax-Span-476" style="font-family: STIXGeneral;">&nbsp;is ripe at&nbsp;</span><span class="texatom" id="MathJax-Span-477"><span class="mrow" id="MathJax-Span-478"><span class="msubsup" id="MathJax-Span-479"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.53em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-480" style="font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.53em;"><span class="mi" id="MathJax-Span-481" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-482" style="font-family: STIXGeneral; padding-left: 0.296em;"></span><span class="mi" id="MathJax-Span-483" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.296em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.106em, 1003.87em, 4.16em, -999.997em); top: -3.334em; left: 0em;"><span class="mtd" id="MathJax-Span-494"><span class="mrow" id="MathJax-Span-495"><span class="mtext" id="MathJax-Span-496" style="font-family: STIXGeneral;">otherwise</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-497"></span></span></span><span style="display: inline-block; width: 0px; height: 4.101em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.425em; border-left: 0px solid; width: 0px; height: 3.432em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>u</mi><mo>,</mo><mi></mi></mrow></msub><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><msubsup><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>u</mi><mo>,</mo><mi></mi></mrow><mo></mo></msubsup><mo>,</mo><msub><mi>w</mi><mi>u</mi></msub><mo>+</mo><msubsup><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>u</mi><mo>,</mo><msub><mi>d</mi><mi>u</mi></msub></mrow><mo></mo></msubsup><mo stretchy="false">)</mo></mtd><mtd><mrow><mtext>if fruit in&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mi>u</mi></mrow><mtext>&nbsp;is ripe at&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><msub><mi>d</mi><mi>u</mi></msub><mo></mo><mi></mi></mrow></mrow></mtd></mtr><mtr><mtd><msubsup><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>u</mi><mo>,</mo><mi></mi></mrow><mo></mo></msubsup></mtd><mtd><mtext>otherwise</mtext></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-58">C_{u, \ell} = \begin{cases} \max( C'_{u, \ell}, w_u + C'_{u, d_u}) & \text{if fruit in $u$ is ripe at $d_u \leq \ell$} \\ C'_{u, \ell} & \text{otherwise} \end{cases}</script> Obviously the above recurrence can be computed in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;c&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;/mrow&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-498" style="width: 10.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.609em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1008.55em, 2.872em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-499"><span class="mi" id="MathJax-Span-500" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-501" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-502" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-503" style="font-family: STIXGeneral; padding-left: 0.237em;"></span><span class="texatom" id="MathJax-Span-504" style="padding-left: 0.237em;"><span class="mrow" id="MathJax-Span-505"><span class="mi" id="MathJax-Span-506" style="font-family: STIXGeneral;">#</span><span class="mtext" id="MathJax-Span-507" style="font-family: STIXGeneral;">&nbsp;</span><span class="mi" id="MathJax-Span-508" style="font-family: STIXGeneral;">c</span><span class="mi" id="MathJax-Span-509" style="font-family: STIXGeneral;">h</span><span class="mi" id="MathJax-Span-510" style="font-family: STIXGeneral;">i</span><span class="mi" id="MathJax-Span-511" style="font-family: STIXGeneral;">l</span><span class="mi" id="MathJax-Span-512" style="font-family: STIXGeneral;">d</span><span class="mi" id="MathJax-Span-513" style="font-family: STIXGeneral;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-514" style="font-family: STIXGeneral;">e</span><span class="mi" id="MathJax-Span-515" style="font-family: STIXGeneral;">n</span><span class="mtext" id="MathJax-Span-516" style="font-family: STIXGeneral;">&nbsp;</span><span class="mi" id="MathJax-Span-517" style="font-family: STIXGeneral;">o</span><span class="mi" id="MathJax-Span-518" style="font-family: STIXGeneral;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mtext" id="MathJax-Span-519" style="font-family: STIXGeneral;">&nbsp;</span></span></span><span class="mi" id="MathJax-Span-520" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-521" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>k</mi><mo></mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">#</mi><mtext>&nbsp;</mtext><mi mathvariant="normal">c</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mtext>&nbsp;</mtext><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mtext>&nbsp;</mtext></mrow><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-59">O(k\cdot \mathrm{\#~children~of~} v)</script> in a vertex <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-522" style="width: 0.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.53em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-523"><span class="mi" id="MathJax-Span-524" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-60">v</script>. As each vertex can be a child of only a single vertex the total time complexity is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-525" style="width: 3.047em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.462em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1002.4em, 2.872em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-526"><span class="mi" id="MathJax-Span-527" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-528" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-529" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-530" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-531" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>k</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-61">O(nk)</script>.</p><p>This solves subtasks <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-532" style="width: 0.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1000.53em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-533"><span class="mn" id="MathJax-Span-534" style="font-family: STIXGeneral;">4</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-62">4</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-535" style="width: 0.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1000.47em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-536"><span class="mn" id="MathJax-Span-537" style="font-family: STIXGeneral;">5</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>5</mn></math></span></span><script type="math/tex" id="MathJax-Element-63">5</script>, and if we also compress the coordinates and the tree, it solves subtask <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-538" style="width: 0.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1000.47em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-539"><span class="mn" id="MathJax-Span-540" style="font-family: STIXGeneral;">6</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>6</mn></math></span></span><script type="math/tex" id="MathJax-Element-64">6</script>.</p><p><span class="tex-font-style-bf">Improving the dynamic programming</span></p><p>We will now do several small steps that will ultimately result in an <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-541" style="width: 5.448em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.453em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.467em, 1004.39em, 2.93em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-542"><span class="mi" id="MathJax-Span-543" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-544" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-545" style="font-family: STIXGeneral; font-style: italic;"></span><span class="msubsup" id="MathJax-Span-546" style="padding-left: 0.179em;"><span style="display: inline-block; position: relative; width: 1.701em; height: 0px;"><span style="position: absolute; clip: rect(3.106em, 1001.23em, 4.394em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-547" style="font-family: STIXGeneral;">log</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.388em; left: 1.291em;"><span class="mn" id="MathJax-Span-548" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-549"></span><span class="mi" id="MathJax-Span-550" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.179em;"></span><span class="mo" id="MathJax-Span-551" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><msup><mi>log</mi><mn>2</mn></msup><mo></mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-65">O(n\log^2 n)</script> solution.</p><p>First of all note that for a fixed vertex <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-552" style="width: 0.588em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.41em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-553"><span class="mi" id="MathJax-Span-554" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-66">u</script> the values <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-555" style="width: 1.818em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.467em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.35em, 1001.47em, 2.579em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-556"><span class="msubsup" id="MathJax-Span-557"><span style="display: inline-block; position: relative; width: 1.467em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-558" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.647em;"><span class="texatom" id="MathJax-Span-559"><span class="mrow" id="MathJax-Span-560"><span class="mi" id="MathJax-Span-561" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-562" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-563" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>u</mi><mo>,</mo><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-67">C_{u,i}</script>'s are non-decreasing function of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-564" style="width: 0.354em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.296em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.24em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-565"><span class="mi" id="MathJax-Span-566" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-68">i</script>.</p><p>A nontrivial observation is that there are not arbitrarily many distinct values of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-567" style="width: 1.818em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.467em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.35em, 1001.47em, 2.579em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-568"><span class="msubsup" id="MathJax-Span-569"><span style="display: inline-block; position: relative; width: 1.467em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-570" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.647em;"><span class="texatom" id="MathJax-Span-571"><span class="mrow" id="MathJax-Span-572"><span class="mi" id="MathJax-Span-573" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-574" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-575" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>u</mi><mo>,</mo><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-69">C_{u,i}</script>'s. In particular, there are at most one more than the number of vertices in the subtree of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-576" style="width: 0.588em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.41em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-577"><span class="mi" id="MathJax-Span-578" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-70">u</script>, as the steps in this function can occur only at days when a fruit is ripe. We can use this to obtain a sparse representaiton of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-579" style="width: 1.818em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.467em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.35em, 1001.47em, 2.579em, -999.997em); top: -2.163em; left: 0em;"><span class="mrow" id="MathJax-Span-580"><span class="msubsup" id="MathJax-Span-581"><span style="display: inline-block; position: relative; width: 1.467em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.71em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-582" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.803em; left: 0.647em;"><span class="texatom" id="MathJax-Span-583"><span class="mrow" id="MathJax-Span-584"><span class="mi" id="MathJax-Span-585" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-586" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-587" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>u</mi><mo>,</mo><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-71">C_{u,i}</script> which will be <span class="tex-font-style-it">increasing</span>.</p><p>For example the following function </p><pre class="verbatim">t       1 2 3 4 5 ... k<br>C[u,t]  0 2 2 3 4 ... 4<br></pre> is compressed as <pre class="verbatim">2 4 5<br>2 3 4<br></pre><p>If we represent these in a simple array we can do the merge of two sparse representations of the functions using two pointers. This can give us a solution in which we process a vertex <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-588" style="width: 0.588em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.41em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-589"><span class="mi" id="MathJax-Span-590" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-72">u</script> in time proportional to the size of its subtree  i.e., worst-case <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-591" style="width: 2.872em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.345em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.525em, 1002.29em, 2.872em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-592"><span class="mi" id="MathJax-Span-593" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-594" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-595"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.34em, 1000.47em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-596" style="font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.33em; left: 0.471em;"><span class="mn" id="MathJax-Span-597" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-598" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-73">O(n^2)</script>.</p><p>(Note that another related way to get an <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-599" style="width: 2.872em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.345em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.525em, 1002.29em, 2.872em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-600"><span class="mi" id="MathJax-Span-601" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-602" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-603"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.34em, 1000.47em, 4.16em, -999.997em); top: -3.978em; left: 0em;"><span class="mi" id="MathJax-Span-604" style="font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.33em; left: 0.471em;"><span class="mn" id="MathJax-Span-605" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-606" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-74">O(n^2)</script> solution when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-607" style="width: 0.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.53em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-608"><span class="mi" id="MathJax-Span-609" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-75">k</script> is much larger than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-610" style="width: 0.588em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.41em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-611"><span class="mi" id="MathJax-Span-612" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-76">n</script> is to do coordinate compression on the times when the fruits become ripe.)</p><p>At this point we assume that our tree is a binary tree as arbitrary tree can be always converted into a binary tree. Hence we will only be merging two arrays into one.</p><p>In order to do this efficiently we have to represent our sparse function in a different datastructure as we cannot afford to run both pointers on the full range of the larger array. This datastructure is a range tree  one stores the ranges where the function value is constant. To combine two trees, one can iterate over all ranges in one of the trees, and perform a range addition on the second tree. Two trees can thus be combined in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-613" style="width: 5.155em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.218em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1004.16em, 2.93em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-614"><span class="mi" id="MathJax-Span-615" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-616" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-617" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-618" style="font-family: STIXGeneral; padding-left: 0.179em;">log</span><span class="mo" id="MathJax-Span-619"></span><span class="mi" id="MathJax-Span-620" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.179em;"></span><span class="mo" id="MathJax-Span-621" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mi>log</mi><mo></mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-77">O(m \log n)</script>, where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-622" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.876em, 1000.65em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-623"><span class="mi" id="MathJax-Span-624" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-78">m</script> is the size of the smaller of the trees. Merging a smaller structure into larger one is a well know trick that only adds a logarithmic factor. Furthermore, the act of adding a fruit to a representation can also be done in time <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-625" style="width: 4.101em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.34em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1003.28em, 2.93em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-626"><span class="mi" id="MathJax-Span-627" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-628" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-629" style="font-family: STIXGeneral;">log</span><span class="mo" id="MathJax-Span-630"></span><span class="mi" id="MathJax-Span-631" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.179em;"></span><span class="mo" id="MathJax-Span-632" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo></mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-79">O(\log n)</script> by one lookup and one range addition.</p><p>For subtask <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-633" style="width: 0.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.47em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-634"><span class="mn" id="MathJax-Span-635" style="font-family: STIXGeneral;">7</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>7</mn></math></span></span><script type="math/tex" id="MathJax-Element-80">7</script>, we don't even need a range tree  a simple multiset is enough. In this multiset we store the IDs of days in which a fruit can be harvest from a subtree. Each prefix of this multiset gives us the number of fruits that may be harvested until a particular day, although the set itself is not necessarily correct. Merging subtrees from two siblings is a simple smaller-to-larger merge. To process fruit that is in the root of a subtree, we first remove the earliest fruit that ripes after the fruit in the root, if any, and then add the fruit itself.</p></div></div></div></div> <div><h3><a href="https://codeforces.com/contest/1193/problem/C" title="CEOI 2019 day 2 online mirror (unrated, IOI format)">1193C - Scissors and Tape</a></h3><div class="ttypography"><div class="problem-statement"><div><p>There are many correct approaches. We will describe one that's reasonably simple to implement. We'll start with some basic shapes and we'll work our way up to general polygons.</p><p>Step one: a nice rectangle to another nice rectangle</p><p>We will do this in a series of steps. While the input rectangle is at least twice as wide (or twice as tall) as the other, cut it in half and place those halves one on top of the other. For the final step (if needed) we can go directly from one rectangle to the other by cutting it into three pieces and shifting two of them, as shown in the figure below.</p><p><img class="tex-graphics" src="./ceoi-day2_files/fb197bdf81b1e4a7215e23021887d2ecefeccc41.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>Step two: any triangle to a nice rectangle</p><p>Move the input triangle so that its longest side is on the x-axis and its other vertex has positive y. (You can "abuse" the tape operation with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-636" style="width: 2.813em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.286em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1002.17em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-637"><span class="mi" id="MathJax-Span-638" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-639" style="font-family: STIXGeneral; padding-left: 0.296em;">=</span><span class="mn" id="MathJax-Span-640" style="font-family: STIXGeneral; padding-left: 0.296em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-81">k=1</script> to do this.) Then, cut it horizontally at half of its height and cut the top part vertically through the vertex. The three pieces can be reassembled to form a rectangle.</p><p>Step three: a nice rectangle to a triangle</p><p>This is just step two backwards: resize the rectangle to be as wide as the longest side of the triangle, then cut it in three pieces and assemble the triangle you need.</p><p><img class="tex-graphics" src="./ceoi-day2_files/27866870d6b99614b70c86e7b2e81e09bd4b996c.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>For the full construction, we can now go as follows: Triangulate the input polygon. Change each triangle into a rectangle. Resize all rectangles to have the same height. Tape them to a single rectangle <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-641" style="width: 0.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.764em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.76em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-642"><span class="mi" id="MathJax-Span-643" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-82">R</script> of that height. </p><p>Triangulate the output polygon to know the areas of its triangles. Cut <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-644" style="width: 0.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.764em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.76em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-645"><span class="mi" id="MathJax-Span-646" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-83">R</script> into rectangles of those areas. Transform each rectangle to the corresponding triangle, and tape them all together.</p><p>An alternate full construction is can be implemented by having "triangle to triangle" as a primitive and then taking the triangulations of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-647" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.71em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-648"><span class="mi" id="MathJax-Span-649" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-84">S</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-650" style="width: 0.823em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.647em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.65em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-651"><span class="mi" id="MathJax-Span-652" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-85">T</script> and additionally cutting some of their triangles into two so that you'll get two collections of triangles of matching areas. (Imagine having a list of triangles from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-653" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.71em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-654"><span class="mi" id="MathJax-Span-655" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-86">S</script> and a list of triangles from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-656" style="width: 0.823em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.647em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.701em, 1000.65em, 2.696em, -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-657"><span class="mi" id="MathJax-Span-658" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-87">T</script>. You read both lists at the same time and whenever the areas don't match you cut off and use an appropriate part of the bigger triangle.)</p><p><img class="tex-graphics" src="./ceoi-day2_files/51a136b059d9cb0a13a0e657dfc27762930087cb.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>Historic background: The equivalence relation between objects that can be obtained by a finite number of our "scissors" and "tape" steps is better known under the name scissors congruence. Wallace, Bolyai and Gerwien were the first to show that in 2D any two polygons with the same area are scissors-congruent. The 3D version of this problem was one of Hilbert's problems, and it was the first one solved  with a negative result. Within a year of Hilbert's talk, his student Dehn constructed two polyhedra with the same volume that are not scissors-congruent.</p></div></div></div></div></div>
    </div>

    <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
    <img src="./ceoi-day2_files/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/1193" class="notice" style="text-decoration: none;">CEOI 2019 day 2 online mirror (unrated, IOI format)</a></span>
    </div>

        <div style="font-size: 1.1rem;line-height: 11px;">
            <img style="vertical-align: middle;" src="./ceoi-day2_files/tags.png" title="Tags" alt="Tags">
                <span style="padding: 0 0.35em;">
    <a href="https://codeforces.com/search?query=ceoi" class="tag notice" style="text-decoration: none;">ceoi</a>,
                </span>
                <span style="padding: 0 0.35em;">
    <a href="https://codeforces.com/search?query=ceoi2019" class="tag notice" style="text-decoration: none;">ceoi2019</a>
                </span>
        </div>

    <div class="roundbox meta" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
        <div class="left-meta">
            <ul>
                    <li style="line-height: 1.6em;">        <a href="https://codeforces.com/blog/entry/68748#" class="topic-vote-up-69219"><img style="vertical-align:middle;position:relative;top:-0.2em" src="./ceoi-day2_files/voteup.png" alt="Vote: I like it" title="Vote: I like it"></a>


</li>
                    <li style="line-height: 1.6em;">

        
        <span title="Topic rating" style="font-size:larger;position:relative;bottom:1px;font-weight:bold;color:green">+30</span>
        
</li>
                    <li style="line-height: 1.6em;">        <a href="https://codeforces.com/blog/entry/68748#" class="topic-vote-down-69219"><img style="vertical-align:middle;position:relative;top:-0.2em" src="./ceoi-day2_files/votedown.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>


</li>
            </ul>
        </div>


        <span style="position: relative; line-height: 1.65em; top: 0.75rem; left: 0.8em;">

    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="BLOG_ENTRY" data-entityid="68748" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

        </span>

        <div class="right-meta">
            <ul>
                    <li>        <a href="https://codeforces.com/profile/majk"><img style="vertical-align:middle;position:relative;top:-1px" src="./ceoi-day2_files/user_16x16.png" alt="Author" title="Author"></a>


        <a href="https://codeforces.com/profile/majk">
        majk
        </a>
</li>
                    <li>        <img style="vertical-align:middle;position:relative;top:-1px" src="./ceoi-day2_files/date_16x16.png" alt="Publication date" title="Publication date">


        
        <span class="format-humantime" title="Jul/27/2019 19:53 UTC-7">40 hours ago</span>
        
</li>
                    <li>        <a href="https://codeforces.com/blog/entry/68748#comments"><img style="vertical-align:middle;position:relative;top:-1px" src="./ceoi-day2_files/comments_16x16.png" alt="Comments" title="Comments"></a>


        <a href="https://codeforces.com/blog/entry/68748#comments">
        30
        </a>
</li>
            </ul>
        </div>

        <br style="clear:both;">
    </div>


<div class="comments" commentableid="73371">
    <div class="title">
        <img src="./ceoi-day2_files/comments-48x48.png" alt="Comments" title="Comments" style="position:relative;top:0.6em;">
        <a name="comments">Comments (30)</a>
    </div>
    <div><a href="https://codeforces.com/blog/entry/68748#" class="new-root-comment" style="float:right;position:relative;bottom:3.25em;">Write comment?</a></div>

<div class="comment">
    <table class="comment-table" commentid="530822" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/dacin21" style="position: relative;">
<img src="./ceoi-day2_files/no-avatar.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="./ceoi-day2_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:5px;right:10px">        </a>
        <div><a href="https://codeforces.com/profile/dacin21" title="International Grandmaster dacin21" class="rated-user user-red">dacin21</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/27/2019 20:23 UTC-7">39 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530822" href="https://codeforces.com/blog/entry/68748?#comment-530822" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530822" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="530822" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/68748#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision"></a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/68748#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision"></a>
                        </span>
                        &nbsp;

<span commentid="530822" data-commentrating="3" data-commentuserid="303260">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530822">
                    <div class="moveup">
                    <div class="ttypography"><p>Alternate solution for A: The answer is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-659" style="width: 1.075em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.886em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.201em, 1000.89em, 2.714em, -999.997em); top: -2.141em; left: 0em;"><span class="mrow" id="MathJax-Span-660"><span class="mfrac" id="MathJax-Span-661"><span style="display: inline-block; position: relative; width: 0.634em; height: 0px; margin-right: 0.129em; margin-left: 0.129em;"><span style="position: absolute; clip: rect(3.471em, 1000.51em, 4.165em, -999.997em); top: -4.41em; left: 50%; margin-left: -0.249em;"><span class="mi" id="MathJax-Span-662" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span><span style="position: absolute; clip: rect(3.282em, 1000.32em, 4.165em, -999.997em); top: -3.591em; left: 50%; margin-left: -0.186em;"><span class="mn" id="MathJax-Span-663" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span><span style="position: absolute; clip: rect(0.823em, 1000.63em, 1.264em, -999.997em); top: -1.258em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.634em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.075em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.147em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.535em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mi>m</mi><mn>2</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-88">\frac{m}{2}</script> times the number of acyclic orientations of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-664" style="width: 0.949em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1000.76em, 2.714em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-665"><span class="mi" id="MathJax-Span-666" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-89">G</script>. To count them, compute the chromatic polynomial in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msup&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-667" style="width: 3.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.093em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1003.03em, 2.904em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-668"><span class="mi" id="MathJax-Span-669" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-670" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-671" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mtext" id="MathJax-Span-672" style="font-family: STIXGeneral;">&nbsp;</span><span class="msubsup" id="MathJax-Span-673"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(3.093em, 1000.45em, 4.165em, -999.997em); top: -3.969em; left: 0em;"><span class="mn" id="MathJax-Span-674" style="font-family: STIXGeneral;">3</span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span><span style="position: absolute; top: -4.347em; left: 0.508em;"><span class="mi" id="MathJax-Span-675" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span></span></span><span class="mo" id="MathJax-Span-676" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mtext>&nbsp;</mtext><msup><mn>3</mn><mi>n</mi></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-90">O(n\ 3^n)</script> by some dp where you partition the vertices into <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-677" style="width: 4.858em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.975em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1003.98em, 2.84em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-678"><span class="mn" id="MathJax-Span-679" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-680" style="font-family: STIXGeneral;">,</span><span class="mn" id="MathJax-Span-681" style="font-family: STIXGeneral; padding-left: 0.192em;">2</span><span class="mo" id="MathJax-Span-682" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-683" style="font-family: STIXGeneral; padding-left: 0.192em;"></span><span class="mo" id="MathJax-Span-684" style="font-family: STIXGeneral; padding-left: 0.192em;">,</span><span class="mi" id="MathJax-Span-685" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.192em;"></span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.227em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo></mo><mo>,</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-91">1, 2, \dots, n</script> independent sets, evaluate it at <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-686" style="width: 1.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1001.08em, 2.84em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-687"><span class="mo" id="MathJax-Span-688" style="font-family: STIXGeneral;"></span><span class="mn" id="MathJax-Span-689" style="font-family: STIXGeneral;">1</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.227em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo></mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-92">-1</script> and multiply by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-690" style="width: 2.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.273em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1002.27em, 2.904em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-691"><span class="mo" id="MathJax-Span-692" style="font-family: STIXGeneral;">(</span><span class="mo" id="MathJax-Span-693" style="font-family: STIXGeneral;"></span><span class="mn" id="MathJax-Span-694" style="font-family: STIXGeneral;">1</span><span class="msubsup" id="MathJax-Span-695"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.093em, 1000.32em, 4.354em, -999.997em); top: -3.969em; left: 0em;"><span class="mo" id="MathJax-Span-696" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span><span style="position: absolute; top: -4.347em; left: 0.318em;"><span class="texatom" id="MathJax-Span-697"><span class="mrow" id="MathJax-Span-698"><span class="mi" id="MathJax-Span-699" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo></mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-93">(-1)^{n}</script>. (I never though that I would use that theorem some day.) This gives <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;63&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-700" style="width: 1.264em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.012em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1000.95em, 2.714em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-701"><span class="mn" id="MathJax-Span-702" style="font-family: STIXGeneral;">63</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>63</mn></math></span></span><script type="math/tex" id="MathJax-Element-94">63</script> points, to get <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;100&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-703" style="width: 1.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.516em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1001.52em, 2.714em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-704"><span class="mn" id="MathJax-Span-705" style="font-family: STIXGeneral;">100</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>100</mn></math></span></span><script type="math/tex" id="MathJax-Element-95">100</script> you need to remove vertices of degrees <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-706" style="width: 1.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.516em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1001.39em, 2.84em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-707"><span class="mo" id="MathJax-Span-708" style="font-family: STIXGeneral;"></span><span class="mn" id="MathJax-Span-709" style="font-family: STIXGeneral; padding-left: 0.318em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.227em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo></mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-96">\leq 1</script>.</p><p>I knew the theoretical solution to C from maths, but I didn't want to implement it.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530822 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530822 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530822">
            <li>
<div class="comment">
    <table class="comment-table" commentid="530826" commentparentid="530822">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/majk" style="position: relative;">
<img src="./ceoi-day2_files/362bcb75322ed2ca.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="./ceoi-day2_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/majk" title="International Grandmaster majk" class="rated-user user-red">majk</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/27/2019 20:37 UTC-7">39 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530826" href="https://codeforces.com/blog/entry/68748?#comment-530826" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530822" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530826" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

    <script type="text/javascript">
        $(document).ready(function () {
            $("img.toggle-favourite").click(function () {
                var size = $(this).attr("data-size");
                var img = $(this);

                var isFavourite = !img.hasClass("remove-favourite");
                var type = img.attr("data-type");
                var entityId = img.attr("data-entityId");

                $.post("/data/favourite",
                        { entityId: entityId, type: type, isFavourite: isFavourite },
                        function(response) {
                            if (response["success"] != "true") {
                                alert(response["message"]);
                            } else {
                                if (img.hasClass("remove-favourite")) {
                                    img.attr("src", "//sta.codeforces.com/s/16651/images/icons/star_gray_" + size + ".png");
                                    img.removeClass("remove-favourite");
                                    img.addClass("add-favourite");
                                } else {
                                    img.attr("src", "//sta.codeforces.com/s/16651/images/icons/star_yellow_" + size + ".png");
                                    img.removeClass("add-favourite");
                                    img.addClass("remove-favourite");
                                }
                            }
                        }, "json"
                );

                return false;
            });
        });
    </script>
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="530826" revisioncount="2" revision="2">
                            <a href="https://codeforces.com/blog/entry/68748#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision"></a>
                            Rev. <span class="revision">2</span>
                            <a href="https://codeforces.com/blog/entry/68748#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision"></a>
                        </span>
                        &nbsp;

<span commentid="530826" data-commentrating="0" data-commentuserid="425662">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530826">
                    <div class="moveup">
                    <div class="ttypography"><p>We knew about this solution, but we didn't think it could pass the TL. Also, the fact that this is googleable is less of a concern for the onsite.</p><p>We also considered some slight modification to the cost function or further limit the set of allowed operations, but doing so complicated the statement too much.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530826 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530826 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530826">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="530829" commentparentid="530822">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/sunset" style="position: relative;">
<img src="./ceoi-day2_files/7812250c2d657b53.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="./ceoi-day2_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/sunset" title="Legendary grandmaster sunset" class="rated-user user-legendary"><span class="legendary-user-first-letter">s</span>unset</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/27/2019 20:46 UTC-7">39 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530829" href="https://codeforces.com/blog/entry/68748?#comment-530829" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530822" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530829" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530829" data-commentrating="3" data-commentuserid="455703">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530829">
                    <div class="moveup">
                    <div class="ttypography"><p>The value of chromatic polynomial <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-710" style="width: 2.399em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.958em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1001.89em, 2.904em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-711"><span class="mi" id="MathJax-Span-712" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mo" id="MathJax-Span-713" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-714" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-715" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-97">C(x)</script> when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-716" style="width: 3.723em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.03em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1002.9em, 2.84em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-717"><span class="mi" id="MathJax-Span-718" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-719" style="font-family: STIXGeneral; padding-left: 0.318em;">=</span><span class="mo" id="MathJax-Span-720" style="font-family: STIXGeneral; padding-left: 0.318em;"></span><span class="mn" id="MathJax-Span-721" style="font-family: STIXGeneral;">1</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.227em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mo></mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-98">x=-1</script> can be computed in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-722" style="width: 4.038em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.282em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.516em, 1003.22em, 2.904em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-723"><span class="mi" id="MathJax-Span-724" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-725" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-726"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(3.093em, 1000.51em, 4.165em, -999.997em); top: -3.969em; left: 0em;"><span class="mn" id="MathJax-Span-727" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span><span style="position: absolute; top: -4.347em; left: 0.508em;"><span class="mi" id="MathJax-Span-728" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-729"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.45em, 4.165em, -999.997em); top: -3.969em; left: 0em;"><span class="mi" id="MathJax-Span-730" style="font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span><span style="position: absolute; top: -4.347em; left: 0.508em;"><span class="mn" id="MathJax-Span-731" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span></span></span><span class="mo" id="MathJax-Span-732" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>n</mi></msup><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-99">O(2^nn^2)</script> by subset power series.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530829 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530829 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530829">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="530831" commentparentid="530822">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Xellos" style="position: relative;">
<img src="./ceoi-day2_files/219f6d18d95969d.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="./ceoi-day2_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/Xellos" title="International Grandmaster Xellos" class="rated-user user-red">Xellos</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/27/2019 20:51 UTC-7">39 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530831" href="https://codeforces.com/blog/entry/68748?#comment-530831" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530822" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530831" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530831" data-commentrating="2" data-commentuserid="69675">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+2</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530831">
                    <div class="moveup">
                    <div class="ttypography"><p>You know what you can do for 63 points? Add vertices in layers. The top layer is made up by all vertices with indegree 0 (in the resulting DAG), the second layer by all vertices with indegree 0 when those are removed and so on. Each layer has to contain no internal edges and each of its vertices has to be connected to the previous layer; this means a sequence of layers uniquely defines a DAG. You can just generate all valid pairs of (this layer, previous layer) and do a DP where each state is (vertices in all layers so far, last layer). Much simpler and much more intuitive, since it just fixes the wrong idea "add vertices one by one and keep the set of those added so far".</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530831 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530831 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530831">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="530823" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/TLE" style="position: relative;">
<img src="./ceoi-day2_files/9a96aca3e9089750.jpg">        </a>
        <div><a href="https://codeforces.com/profile/TLE" title="International Grandmaster TLE" class="rated-user user-red">TLE</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/27/2019 20:30 UTC-7">39 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530823" href="https://codeforces.com/blog/entry/68748?#comment-530823" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530823" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530823" data-commentrating="40" data-commentuserid="147418">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+40</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530823">
                    <div class="moveup">
                    <div class="ttypography"><p>Problem C is usually known as <a href="http://www.cut-the-knot.org/do_you_know/Bolyai.shtml">Wallace-Bolyai-Gerwien Theorem</a>.</p><p>Also problem A can be solved in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-733" style="width: 4.038em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.282em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.516em, 1003.22em, 2.904em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-734"><span class="mi" id="MathJax-Span-735" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-736" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-737"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(3.093em, 1000.51em, 4.165em, -999.997em); top: -3.969em; left: 0em;"><span class="mn" id="MathJax-Span-738" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span><span style="position: absolute; top: -4.347em; left: 0.508em;"><span class="mi" id="MathJax-Span-739" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-740"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(3.345em, 1000.45em, 4.165em, -999.997em); top: -3.969em; left: 0em;"><span class="mi" id="MathJax-Span-741" style="font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span><span style="position: absolute; top: -4.347em; left: 0.508em;"><span class="mn" id="MathJax-Span-742" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span></span></span><span class="mo" id="MathJax-Span-743" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>n</mi></msup><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-100">O(2^n n^2)</script> time. Will write about it when I have some more time (hopefully).</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530823 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530823 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530823">
            <li>
<div class="comment">
    <table class="comment-table" commentid="530827" commentparentid="530823">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Xellos" style="position: relative;">
<img src="./ceoi-day2_files/219f6d18d95969d.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="./ceoi-day2_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/Xellos" title="International Grandmaster Xellos" class="rated-user user-red">Xellos</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/27/2019 20:43 UTC-7">39 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530827" href="https://codeforces.com/blog/entry/68748?#comment-530827" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530823" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530827" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530827" data-commentrating="3" data-commentuserid="69675">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530827">
                    <div class="moveup">
                    <div class="ttypography"><p>We're aware. The point is to solve it without knowledge of chromatic polynomials.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530827 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530827 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530827">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="530839" commentparentid="530823">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/ainta" style="position: relative;">
<img src="./ceoi-day2_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/ainta" title="Legendary grandmaster ainta" class="rated-user user-legendary"><span class="legendary-user-first-letter">a</span>inta</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/27/2019 21:59 UTC-7">38 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530839" href="https://codeforces.com/blog/entry/68748?#comment-530839" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530823" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530839" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530839" data-commentrating="0" data-commentuserid="22047">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530839">
                    <div class="moveup">
                    <div class="ttypography"><p>I read your code for problem A, but I wasn't able to understand it.</p><p>(Is it calculating C(-1) where C is chromatic polynomial?)</p><p>I saw that lots of Chinese students are very strong in the problems like problem A. (efficient bitmask dp, squeeze 3^n poly(n) -&gt; 2^n poly(n) ) </p><p>Is there any material to study about this?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530839 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530839 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530839">
            <li>
<div class="comment">
    <table class="comment-table" commentid="530841" commentparentid="530839">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/TLE" style="position: relative;">
<img src="./ceoi-day2_files/9a96aca3e9089750.jpg">        </a>
        <div><a href="https://codeforces.com/profile/TLE" title="International Grandmaster TLE" class="rated-user user-red">TLE</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/27/2019 22:17 UTC-7">38 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530841" href="https://codeforces.com/blog/entry/68748?#comment-530841" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530839" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530841" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530841" data-commentrating="31" data-commentuserid="147418">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+31</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530841">
                    <div class="moveup">
                    <div class="ttypography"><p>Yeah, the rough idea is that if you calculate C(c) when c is sth positive, you're convoluting the independent-set bitmasks c times. And when you're calculating C(-1) you're actually inversing that.</p><p>About some details: assuming you're aware of fmt for calculating or-convolution, then for doing these kinds of disjoint-or-convolution, you only need to add one dimension (popcount) for the arrays and do convolution on the popcounts. So, if 'or's really took effect, the popcounts will be wrong (1s missing) and we'll get the correct result if we only look at the positions with correct popcounts. Finding inverse isn't hard too. Just try to make the result fit.</p><p>I think the awareness about these topics is partly because <a class="rated-user user-red" href="https://codeforces.com/profile/vfleaking" title="Grandmaster vfleaking">vfleaking</a> (thanks, really!) has a well-written tutorial about formal power series (i.e. fwt, fmt etc.) in his 2015 team paper (that every Chinese team member needs to write). Then these tricks become widely known and become popular in Chinese OI-style contests. Probably you can try to read it, but I'm not aware of any translation.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530841 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530841 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530841">
            <li>
<div class="comment">
    <table class="comment-table" commentid="530892" commentparentid="530841">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/ainta" style="position: relative;">
<img src="./ceoi-day2_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/ainta" title="Legendary grandmaster ainta" class="rated-user user-legendary"><span class="legendary-user-first-letter">a</span>inta</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/28/2019 07:03 UTC-7">29 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530892" href="https://codeforces.com/blog/entry/68748?#comment-530892" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530841" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530892" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530892" data-commentrating="14" data-commentuserid="22047">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+14</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530892">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks a lot!</p><p>Where can I read the vfleaking's 2015 team paper about power series (without translation)?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530892 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530892 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530892">
            <li>
<div class="comment">
    <table class="comment-table" commentid="530913" commentparentid="530892">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/bciobanu" style="position: relative;">
<img src="./ceoi-day2_files/603f251bffd69b92.jpg">        </a>
        <div><a href="https://codeforces.com/profile/bciobanu" title="Master bciobanu" class="rated-user user-orange">bciobanu</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/28/2019 15:41 UTC-7">20 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530913" href="https://codeforces.com/blog/entry/68748?#comment-530913" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530892" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530913" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530913" data-commentrating="0" data-commentuserid="318286">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530913">
                    <div class="moveup">
                    <div class="ttypography"><p>I think it's on the <a href="https://github.com/enkerewpo/OI-Public-Library/blob/master/%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F%E8%AE%BA%E6%96%871999-2019/%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F2015%E8%AE%BA%E6%96%87%E9%9B%86.pdf">2015 Chinese IOI team paper</a> starting on page 271.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530913 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530913 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530913">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="530828" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/re_eVVorld" style="position: relative;">
<img src="./ceoi-day2_files/2d3e5b95e0f03743.jpg">        </a>
        <div><a href="https://codeforces.com/profile/re_eVVorld" title="Master re_eVVorld" class="rated-user user-orange">re_eVVorld</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/27/2019 20:45 UTC-7">39 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530828" href="https://codeforces.com/blog/entry/68748?#comment-530828" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530828" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530828" data-commentrating="8" data-commentuserid="331784">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530828">
                    <div class="moveup">
                    <div class="ttypography"><p>There is one more way to solve subtask3 in Amusement Park. It is basically the same as for subtask2 but with one optimization.</p><p>We can pre-compute all possible triangles in O(n^3). Then, (when we build reorientations in our recursive function) if our current edge makes oriented triangle with previous edges we will break current branch of recursion. It helps when number of edges is much bigger than number of vertexes</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530828 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530828 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530828">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="530840" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Xellos" style="position: relative;">
<img src="./ceoi-day2_files/219f6d18d95969d.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="./ceoi-day2_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/Xellos" title="International Grandmaster Xellos" class="rated-user user-red">Xellos</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/27/2019 22:07 UTC-7">38 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530840" href="https://codeforces.com/blog/entry/68748?#comment-530840" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530840" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530840" data-commentrating="0" data-commentuserid="69675">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530840">
                    <div class="moveup">
                    <div class="ttypography"><p>Some details regarding our solution to A:</p> <ul>   <li>This solution can be easily extended to any costs of flipping edges and more general costs of DAGs like (sum of edge costs)^k with an additional O(k^2) in complexity. Can chromatic polynomials be extended in the same way?</li>   <li>The time complexity is approximately O(2.5^n * polynomial) in practice. I suspect the base is sqrt(6); for example, this bound is trivial if the minimum degree is O(n/2) and the maximum number of states induced (generated) by vertices n/2..n-1 being added is O(6^(n/2)). Can you prove that the presented algorithm is actually o(3^n)?</li> </ul></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530840 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530840 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530840">
            <li>
<div class="comment">
    <table class="comment-table" commentid="530844" commentparentid="530840">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Benq" style="position: relative;">
<img src="./ceoi-day2_files/5716ac69aea8159a.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="./ceoi-day2_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/Benq" title="Legendary grandmaster Benq" class="rated-user user-legendary"><span class="legendary-user-first-letter">B</span>enq</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/27/2019 22:33 UTC-7">37 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530844" href="https://codeforces.com/blog/entry/68748?#comment-530844" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530840" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530844" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530844" data-commentrating="21" data-commentuserid="312472">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+21</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530844">
                    <div class="moveup">
                    <div class="ttypography"><p>How do you store the states for A? <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-744" style="width: 2.84em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.336em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1002.27em, 2.904em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-745"><span class="mi" id="MathJax-Span-746" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-747" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-748"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(3.093em, 1000.45em, 4.165em, -999.997em); top: -3.969em; left: 0em;"><span class="mn" id="MathJax-Span-749" style="font-family: STIXGeneral;">3</span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span><span style="position: absolute; top: -4.347em; left: 0.508em;"><span class="mi" id="MathJax-Span-750" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span></span></span><span class="mo" id="MathJax-Span-751" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mn>3</mn><mi>n</mi></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-101">O(3^n)</script> memory is obviously too much. For my last submission, I stored a vector of pairs <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-752" style="width: 6.813em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.552em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1005.49em, 2.904em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-753"><span class="mo" id="MathJax-Span-754" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-755" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-756" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-757" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.192em;"></span><span class="mi" id="MathJax-Span-758" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-759" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-760" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-761" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-762" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-763" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-764" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-765" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>B</mi><mo>,</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>A</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>B</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-102">(B,dp[A][B])</script> for each <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-766" style="width: 0.886em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.697em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1000.63em, 2.714em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-767"><span class="mi" id="MathJax-Span-768" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-103">A</script> but this only works because the number of nonzero states is sparse. Is there a better way to do this?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530844 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530844 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530844">
            <li>
<div class="comment">
    <table class="comment-table" commentid="530850" commentparentid="530844">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Xellos" style="position: relative;">
<img src="./ceoi-day2_files/219f6d18d95969d.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="./ceoi-day2_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/Xellos" title="International Grandmaster Xellos" class="rated-user user-red">Xellos</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/27/2019 23:13 UTC-7">37 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530850" href="https://codeforces.com/blog/entry/68748?#comment-530850" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530844" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530850" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530850" data-commentrating="0" data-commentuserid="69675">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530850">
                    <div class="moveup">
                    <div class="ttypography"><p><code class="tt">vector&lt;unordered_map&gt;</code> is one option, but I used (see my solutions below) a simple <code class="tt">vector&lt;vector&lt;state&gt;&gt;&gt;</code>. I just <code class="tt">push_back</code> and before processing states for a given set of used vertices, I sort them and merge 'states' with the same set of candidates. This adds a logarithm to complexity, but it's actually really fast.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530850 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530850 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530850">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="530847" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Xellos" style="position: relative;">
<img src="./ceoi-day2_files/219f6d18d95969d.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="./ceoi-day2_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/Xellos" title="International Grandmaster Xellos" class="rated-user user-red">Xellos</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/27/2019 23:09 UTC-7">37 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530847" href="https://codeforces.com/blog/entry/68748?#comment-530847" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530847" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530847" data-commentrating="0" data-commentuserid="69675">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530847">
                    <div class="moveup">
                    <div class="ttypography"><p>My solutions:</p> <ul>   <li>A: <a href="https://codeforces.com/contest/1193/submission/57902147" title="Submission 57902147 by Xellos">57902147</a></li>   <li>B: <a href="https://codeforces.com/contest/1193/submission/57902160" title="Submission 57902160 by Xellos">57902160</a></li> </ul><p>I don't have one for C, maybe later.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530847 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530847 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530847">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="530861" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/egor.lifar" style="position: relative;">
<img src="./ceoi-day2_files/af7e6b11675609fb.jpg">        </a>
        <div><a href="https://codeforces.com/profile/egor.lifar" title="Grandmaster egor.lifar" class="rated-user user-red">egor.lifar</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/28/2019 01:24 UTC-7">34 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530861" href="https://codeforces.com/blog/entry/68748?#comment-530861" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530861" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530861" data-commentrating="5" data-commentuserid="96110">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530861">
                    <div class="moveup">
                    <div class="ttypography"><p>I think that checker for problem C is not complete. In my submission in test 3(<a href="https://codeforces.com/contest/1193/submission/57907084">https://codeforces.com/contest/1193/submission/57907084</a>) I tried to print a tape operation with the rotated rectangle in a result, but checker did not get it. But from the equivalent definition it seems that we can actually rotate figures. Can you please check this issue? </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530861 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530861 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530861">
            <li>
<div class="comment">
    <table class="comment-table" commentid="530879" commentparentid="530861">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Xellos" style="position: relative;">
<img src="./ceoi-day2_files/219f6d18d95969d.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="./ceoi-day2_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/Xellos" title="International Grandmaster Xellos" class="rated-user user-red">Xellos</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/28/2019 03:50 UTC-7">32 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530879" href="https://codeforces.com/blog/entry/68748?#comment-530879" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530861" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530879" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530879" data-commentrating="10" data-commentuserid="69675">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+10</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530879">
                    <div class="moveup">
                    <div class="ttypography"><p>If you just want to rotate, the 2 lines you print should be identical. The rotation is uniquely defined by the id of the original shape and by the new partial shape.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530879 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530879 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530879">
            <li>
<div class="comment">
    <table class="comment-table" commentid="530881" commentparentid="530879">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/egor.lifar" style="position: relative;">
<img src="./ceoi-day2_files/af7e6b11675609fb.jpg">        </a>
        <div><a href="https://codeforces.com/profile/egor.lifar" title="Grandmaster egor.lifar" class="rated-user user-red">egor.lifar</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/28/2019 03:56 UTC-7">32 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530881" href="https://codeforces.com/blog/entry/68748?#comment-530881" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530879" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530881" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530881" data-commentrating="0" data-commentuserid="96110">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530881">
                    <div class="moveup">
                    <div class="ttypography"><p>Sorry, I think I've given the wrong link. <a href="https://codeforces.com/contest/1193/submission/57911386">https://codeforces.com/contest/1193/submission/57911386</a> In this attempt I print two identical lines. What's the problem here?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530881 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530881 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530881">
            <li>
<div class="comment">
    <table class="comment-table" commentid="530885" commentparentid="530881">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Xellos" style="position: relative;">
<img src="./ceoi-day2_files/219f6d18d95969d.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="./ceoi-day2_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/Xellos" title="International Grandmaster Xellos" class="rated-user user-red">Xellos</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/28/2019 04:41 UTC-7">31 hour(s) ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530885" href="https://codeforces.com/blog/entry/68748?#comment-530885" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530881" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530885" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530885" data-commentrating="10" data-commentuserid="69675">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+10</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530885">
                    <div class="moveup">
                    <div class="ttypography"><p>You're renumbering the vertices in the rotation. The checker doesn't look at all rotations of your shape and check if one of them satisfies rot(angle, orig_shape.x[i], orig_shape.y[i]) == (rotated_shape.x[i], rotated_shape.y[i]). It only checks if the shape you printed satisfies that.</p><p>In other words, the checker follows a natural action you'd perform if you actually had a piece of paper, scissors and tape, and verifies that you know exactly what actions to perform, not just "I want this polygon to fit here". You pick a polygonal piece you just cut out with scissors and placed somewhere on the desk, and write an integer next to each vertex to make sure everything is labeled and you don't get confused, and you also write an id on each piece. Then, you rotate this piece by some angle; the same happens for other pieces. Then, you move those pieces in some ways and note the new coordinates of their vertices in the same way you numbered them before. Finally, you tape those pieces together, erase all numbers written on them and since you got a new piece, again, you number its vertices nicely in some counter-clockwise order and write an id on it.</p><p>I don't even know the code of the checker. This is all knowledge of the statement (after reading through it in detail several times) and the checker log.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530885 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530885 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530885">
            <li>
<div class="comment">
    <table class="comment-table" commentid="530890" commentparentid="530885">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/egor.lifar" style="position: relative;">
<img src="./ceoi-day2_files/af7e6b11675609fb.jpg">        </a>
        <div><a href="https://codeforces.com/profile/egor.lifar" title="Grandmaster egor.lifar" class="rated-user user-red">egor.lifar</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/28/2019 06:03 UTC-7">30 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530890" href="https://codeforces.com/blog/entry/68748?#comment-530890" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530885" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530890" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530890" data-commentrating="0" data-commentuserid="96110">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530890">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks a lot! Yeah, it makes more sense for me now. Unfortunately it wasn't so clear for me earlier, sorry. I thought that the nodes order importance was mentioned only for the mirroring case.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530890 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530890 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530890">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="530880" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Benq" style="position: relative;">
<img src="./ceoi-day2_files/5716ac69aea8159a.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="./ceoi-day2_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/Benq" title="Legendary grandmaster Benq" class="rated-user user-legendary"><span class="legendary-user-first-letter">B</span>enq</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/28/2019 03:55 UTC-7">32 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530880" href="https://codeforces.com/blog/entry/68748?#comment-530880" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530880" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530880" data-commentrating="3" data-commentuserid="312472">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530880">
                    <div class="moveup">
                    <div class="ttypography"><p>During the actual contest, were contestants able to view the checker log for the example test cases of C? If not, it would have been quite frustrating for those stuck at 0 points ... (Also, why isn't the grader provided for local testing?)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530880 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530880 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530880">
            <li>
<div class="comment">
    <table class="comment-table" commentid="530884" commentparentid="530880">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/majk" style="position: relative;">
<img src="./ceoi-day2_files/362bcb75322ed2ca.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="./ceoi-day2_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/majk" title="International Grandmaster majk" class="rated-user user-red">majk</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/28/2019 04:18 UTC-7">32 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530884" href="https://codeforces.com/blog/entry/68748?#comment-530884" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530880" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530884" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530884" data-commentrating="10" data-commentuserid="425662">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+10</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530884">
                    <div class="moveup">
                    <div class="ttypography"><p>The on-site contestants had the checker freely available as a binary. Showing them just the checker log would be meaningless without also seeing the input, and we did not want to give them the test cases.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530884 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530884 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530884">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="530883" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/ricardogg" style="position: relative;">
<img src="./ceoi-day2_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/ricardogg" title="Unrated, ricardogg" class="rated-user user-black">ricardogg</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/28/2019 04:11 UTC-7">32 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530883" href="https://codeforces.com/blog/entry/68748?#comment-530883" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530883" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530883" data-commentrating="0" data-commentuserid="1174298">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530883">
                    <div class="moveup">
                    <div class="ttypography"><p>Can somebody explain how we do the updates on the multiset in problem B, I tried looking at some submission but I don't understand why many people add and subtract on v values of the dp tables. In particular I was looking at this submission: <a href="https://codeforces.com/contest/1193/submission/57885601" title="Submission 57885601 by TLE">57885601</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530883 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530883 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530883">
            <li>
<div class="comment">
    <table class="comment-table" commentid="530888" commentparentid="530883">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/__.__" style="position: relative;">
<img src="./ceoi-day2_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/__.__" title="International master __.__" class="rated-user user-orange">__.__</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/28/2019 05:59 UTC-7">30 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530888" href="https://codeforces.com/blog/entry/68748?#comment-530888" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530883" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530888" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530888" data-commentrating="0" data-commentuserid="473222">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530888">
                    <div class="moveup">
                    <div class="ttypography"><p>Map stores nonzero dp[i][x]  dp[i][x-1]</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530888 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530888 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530888">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="530918" commentparentid="530883">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Plurm" style="position: relative;">
<img src="./ceoi-day2_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Plurm" title="Candidate Master Plurm" class="rated-user user-violet">Plurm</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/28/2019 16:36 UTC-7">19 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530918" href="https://codeforces.com/blog/entry/68748?#comment-530918" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530883" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530918" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530918" data-commentrating="0" data-commentuserid="493504">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530918">
                    <div class="moveup">
                    <div class="ttypography"><p>I'm not sure if that solution is the same as me, but after I looked into that submission, I think the idea is the same as mine.</p><p>In the official solution, the author mention a data structure called 'range tree' and in subtask 7 we don't have to use range tree. The idea of this solution comes from the idea from solving subtask 7.</p><p>The idea is to keep values in the multiset, but the hard part is when we update the root of a subtree into the set. Consider the non-decreasing array C[u,t] in the official solution, when we update the value of the root of a subtree, one element of C[u,t] will be increased, and the array won't be non-decreasing anymore. We try to fix that by resetting the values after that t.</p><p>For example: <code class="tt">0 2 2 3 4 4 4 5 5 6 9 9 9</code></p><p>may be changed into <code class="tt">0 2 2 3 7 4 4 5 5 6 9 9 9</code></p><p>so we must reset into <code class="tt">0 2 2 3 7 7 7 7 7 7 9 9 9</code></p><p>To process the reset, we can simply erase items in the multiset and if the last item does not match, just subtract the value there.</p><p>The misleading part is that, this sounds like each update takes <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-769" style="width: 2.84em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.336em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.147em, 1002.27em, 3.408em, -999.997em); top: -3.023em; left: 0em;"><span class="mrow" id="MathJax-Span-770"><span class="texatom" id="MathJax-Span-771"><span class="mrow" id="MathJax-Span-772"><span class="mi" id="MathJax-Span-773" style="font-family: STIXNonUnicode; font-style: italic;"></span></span></span><span class="mo" id="MathJax-Span-774" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-775" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mo" id="MathJax-Span-776" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.03em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-104">\mathcal{O}(N)</script>. If we update each nodes, the time would be <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-777" style="width: 3.408em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.777em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.516em, 1002.71em, 2.904em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-778"><span class="mi" id="MathJax-Span-779" style="font-family: STIXGeneral;"></span><span class="mo" id="MathJax-Span-780" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-781"><span style="display: inline-block; position: relative; width: 1.39em; height: 0px;"><span style="position: absolute; clip: rect(3.156em, 1000.89em, 4.165em, -999.997em); top: -3.969em; left: 0em;"><span class="mi" id="MathJax-Span-782" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span><span style="position: absolute; top: -4.347em; left: 0.949em;"><span class="mn" id="MathJax-Span-783" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span></span></span><span class="mo" id="MathJax-Span-784" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal"></mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-105">\Omega(N^2)</script>, but that's wrong, because we can analyze that for each deleted values, they must have been inserted beforehand. Since we can insert only <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-785" style="width: 5.993em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.921em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.147em, 1004.86em, 3.408em, -999.997em); top: -3.023em; left: 0em;"><span class="mrow" id="MathJax-Span-786"><span class="texatom" id="MathJax-Span-787"><span class="mrow" id="MathJax-Span-788"><span class="mi" id="MathJax-Span-789" style="font-family: STIXNonUnicode; font-style: italic;"></span></span></span><span class="mo" id="MathJax-Span-790" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-791" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mi" id="MathJax-Span-792" style="font-family: STIXGeneral; padding-left: 0.192em;">log</span><span class="mo" id="MathJax-Span-793"></span><span class="texatom" id="MathJax-Span-794" style="padding-left: 0.192em;"><span class="mrow" id="MathJax-Span-795"><span class="mi" id="MathJax-Span-796" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span></span></span><span class="mo" id="MathJax-Span-797" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.03em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi>N</mi><mi>log</mi><mo></mo><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-106">\mathcal{O}(N \log{N})</script> values (from merge small into large trick), the erasion (sum of all operations) would be also <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-798" style="width: 5.993em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.921em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.147em, 1004.86em, 3.408em, -999.997em); top: -3.023em; left: 0em;"><span class="mrow" id="MathJax-Span-799"><span class="texatom" id="MathJax-Span-800"><span class="mrow" id="MathJax-Span-801"><span class="mi" id="MathJax-Span-802" style="font-family: STIXNonUnicode; font-style: italic;"></span></span></span><span class="mo" id="MathJax-Span-803" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-804" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mi" id="MathJax-Span-805" style="font-family: STIXGeneral; padding-left: 0.192em;">log</span><span class="mo" id="MathJax-Span-806"></span><span class="texatom" id="MathJax-Span-807" style="padding-left: 0.192em;"><span class="mrow" id="MathJax-Span-808"><span class="mi" id="MathJax-Span-809" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span></span></span><span class="mo" id="MathJax-Span-810" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.03em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi>N</mi><mi>log</mi><mo></mo><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-107">\mathcal{O}(N \log{N})</script> also. So the amortized time is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-811" style="width: 4.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.786em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.147em, 1003.72em, 3.408em, -999.997em); top: -3.023em; left: 0em;"><span class="mrow" id="MathJax-Span-812"><span class="texatom" id="MathJax-Span-813"><span class="mrow" id="MathJax-Span-814"><span class="mi" id="MathJax-Span-815" style="font-family: STIXNonUnicode; font-style: italic;"></span></span></span><span class="mo" id="MathJax-Span-816" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-817" style="font-family: STIXGeneral;">log</span><span class="mo" id="MathJax-Span-818"></span><span class="texatom" id="MathJax-Span-819" style="padding-left: 0.192em;"><span class="mrow" id="MathJax-Span-820"><span class="mi" id="MathJax-Span-821" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span></span></span><span class="mo" id="MathJax-Span-822" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.03em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi>log</mi><mo></mo><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-108">\mathcal{O}(\log{N})</script> per operation, and it takes <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-823" style="width: 4.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.786em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.147em, 1003.72em, 3.408em, -999.997em); top: -3.023em; left: 0em;"><span class="mrow" id="MathJax-Span-824"><span class="texatom" id="MathJax-Span-825"><span class="mrow" id="MathJax-Span-826"><span class="mi" id="MathJax-Span-827" style="font-family: STIXNonUnicode; font-style: italic;"></span></span></span><span class="mo" id="MathJax-Span-828" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-829" style="font-family: STIXGeneral;">log</span><span class="mo" id="MathJax-Span-830"></span><span class="texatom" id="MathJax-Span-831" style="padding-left: 0.192em;"><span class="mrow" id="MathJax-Span-832"><span class="mi" id="MathJax-Span-833" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span></span></span><span class="mo" id="MathJax-Span-834" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.03em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi>log</mi><mo></mo><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-109">\mathcal{O}(\log{N})</script> to change the value of the last element. So the update is in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-835" style="width: 4.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.786em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.147em, 1003.72em, 3.408em, -999.997em); top: -3.023em; left: 0em;"><span class="mrow" id="MathJax-Span-836"><span class="texatom" id="MathJax-Span-837"><span class="mrow" id="MathJax-Span-838"><span class="mi" id="MathJax-Span-839" style="font-family: STIXNonUnicode; font-style: italic;"></span></span></span><span class="mo" id="MathJax-Span-840" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-841" style="font-family: STIXGeneral;">log</span><span class="mo" id="MathJax-Span-842"></span><span class="texatom" id="MathJax-Span-843" style="padding-left: 0.192em;"><span class="mrow" id="MathJax-Span-844"><span class="mi" id="MathJax-Span-845" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span></span></span><span class="mo" id="MathJax-Span-846" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.03em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi>log</mi><mo></mo><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-110">\mathcal{O}(\log{N})</script> amortized.</p><p>Therefore, the running time of the whole solution is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-847" style="width: 6.497em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.299em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.958em, 1005.24em, 3.408em, -999.997em); top: -3.023em; left: 0em;"><span class="mrow" id="MathJax-Span-848"><span class="texatom" id="MathJax-Span-849"><span class="mrow" id="MathJax-Span-850"><span class="mi" id="MathJax-Span-851" style="font-family: STIXNonUnicode; font-style: italic;"></span></span></span><span class="mo" id="MathJax-Span-852" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-853" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="msubsup" id="MathJax-Span-854" style="padding-left: 0.192em;"><span style="display: inline-block; position: relative; width: 1.706em; height: 0px;"><span style="position: absolute; clip: rect(3.093em, 1001.26em, 4.354em, -999.997em); top: -3.969em; left: 0em;"><span class="mi" id="MathJax-Span-855" style="font-family: STIXGeneral;">log</span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span><span style="position: absolute; top: -4.41em; left: 1.264em;"><span class="texatom" id="MathJax-Span-856"><span class="mrow" id="MathJax-Span-857"><span class="mn" id="MathJax-Span-858" style="font-size: 70.7%; font-family: STIXGeneral;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span></span></span><span class="mo" id="MathJax-Span-859"></span><span class="texatom" id="MathJax-Span-860" style="padding-left: 0.192em;"><span class="mrow" id="MathJax-Span-861"><span class="mi" id="MathJax-Span-862" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span></span></span><span class="mo" id="MathJax-Span-863" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.03em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi>N</mi><msup><mi>log</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msup><mo></mo><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-111">\mathcal{O}(N \log^{2}{N})</script> due to merge small into large in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-864" style="width: 5.993em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.921em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.147em, 1004.86em, 3.408em, -999.997em); top: -3.023em; left: 0em;"><span class="mrow" id="MathJax-Span-865"><span class="texatom" id="MathJax-Span-866"><span class="mrow" id="MathJax-Span-867"><span class="mi" id="MathJax-Span-868" style="font-family: STIXNonUnicode; font-style: italic;"></span></span></span><span class="mo" id="MathJax-Span-869" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-870" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mi" id="MathJax-Span-871" style="font-family: STIXGeneral; padding-left: 0.192em;">log</span><span class="mo" id="MathJax-Span-872"></span><span class="mi" id="MathJax-Span-873" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.192em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mo" id="MathJax-Span-874" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.03em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi>N</mi><mi>log</mi><mo></mo><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-112">\mathcal{O}(N \log N)</script> and each operation takes <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-875" style="width: 4.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.786em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.147em, 1003.72em, 3.408em, -999.997em); top: -3.023em; left: 0em;"><span class="mrow" id="MathJax-Span-876"><span class="texatom" id="MathJax-Span-877"><span class="mrow" id="MathJax-Span-878"><span class="mi" id="MathJax-Span-879" style="font-family: STIXNonUnicode; font-style: italic;"></span></span></span><span class="mo" id="MathJax-Span-880" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-881" style="font-family: STIXGeneral;">log</span><span class="mo" id="MathJax-Span-882"></span><span class="texatom" id="MathJax-Span-883" style="padding-left: 0.192em;"><span class="mrow" id="MathJax-Span-884"><span class="mi" id="MathJax-Span-885" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span></span></span><span class="mo" id="MathJax-Span-886" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.03em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi>log</mi><mo></mo><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-113">\mathcal{O}(\log{N})</script> on top.</p><p>Not sure if this is correct or not, but it is my idea during the contest. My submission: <a href="https://codeforces.com/contest/1193/submission/57889967">57889967</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530918 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530918 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530918">
            <li>
<div class="comment">
    <table class="comment-table" commentid="530921" commentparentid="530918">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Xellos" style="position: relative;">
<img src="./ceoi-day2_files/219f6d18d95969d.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="./ceoi-day2_files/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="https://codeforces.com/profile/Xellos" title="International Grandmaster Xellos" class="rated-user user-red">Xellos</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/28/2019 16:46 UTC-7">19 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530921" href="https://codeforces.com/blog/entry/68748?#comment-530921" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530918" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530921" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530921" data-commentrating="5" data-commentuserid="69675">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530921">
                    <div class="moveup">
                    <div class="ttypography"><p>I'm the main author of the range/segment/interval tree idea. I didn't realise until the contest that it's solvable just with map/set, but yeah, it should work. The idea I had is more difficult to implement, but it was the most obvious to me  we just want a structure that implicitly stores an array with size <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-887" style="width: 1.012em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.823em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.706em, 1000.82em, 2.714em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-888"><span class="mi" id="MathJax-Span-889" style="font-family: STIXGeneral; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-114">K</script> and supports operations get(index), set(index, value) and "take this array and add it to the structure in another array", with the realisation that we just need add(l..r, value) for the last operation.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530921 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530921 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530921">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="530893" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Paulliant" style="position: relative;">
<img src="./ceoi-day2_files/5f3d8228e272ae38.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Paulliant" title="Expert Paulliant" class="rated-user user-blue">Paulliant</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/28/2019 09:17 UTC-7">27 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530893" href="https://codeforces.com/blog/entry/68748?#comment-530893" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530893" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="530893" revisioncount="6" revision="6">
                            <a href="https://codeforces.com/blog/entry/68748#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision"></a>
                            Rev. <span class="revision">6</span>
                            <a href="https://codeforces.com/blog/entry/68748#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision"></a>
                        </span>
                        &nbsp;

<span commentid="530893" data-commentrating="22" data-commentuserid="828844">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+22</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530893">
                    <div class="moveup">
                    <div class="ttypography"><p>Here is my <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-890" style="width: 2.84em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.336em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1002.27em, 2.904em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-891"><span class="mi" id="MathJax-Span-892" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-893" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-894"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(3.093em, 1000.45em, 4.165em, -999.997em); top: -3.969em; left: 0em;"><span class="mn" id="MathJax-Span-895" style="font-family: STIXGeneral;">3</span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span><span style="position: absolute; top: -4.347em; left: 0.508em;"><span class="mi" id="MathJax-Span-896" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span></span></span><span class="mo" id="MathJax-Span-897" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mn>3</mn><mi>n</mi></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-115">O(3^n)</script> solution for problem A.</p><p>It's known to all that the final result is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-898" style="width: 1.075em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.886em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.201em, 1000.89em, 2.714em, -999.997em); top: -2.141em; left: 0em;"><span class="mrow" id="MathJax-Span-899"><span class="mfrac" id="MathJax-Span-900"><span style="display: inline-block; position: relative; width: 0.634em; height: 0px; margin-right: 0.129em; margin-left: 0.129em;"><span style="position: absolute; clip: rect(3.471em, 1000.51em, 4.165em, -999.997em); top: -4.41em; left: 50%; margin-left: -0.249em;"><span class="mi" id="MathJax-Span-901" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span><span style="position: absolute; clip: rect(3.282em, 1000.32em, 4.165em, -999.997em); top: -3.591em; left: 50%; margin-left: -0.186em;"><span class="mn" id="MathJax-Span-902" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span><span style="position: absolute; clip: rect(0.823em, 1000.63em, 1.264em, -999.997em); top: -1.258em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.634em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.075em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.147em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.535em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mi>m</mi><mn>2</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-116">m \over 2</script> times the ways to construct a DAG of graph <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-117-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-903" style="width: 0.949em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1000.76em, 2.714em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-904"><span class="mi" id="MathJax-Span-905" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-117">G</script>, suppose <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-906" style="width: 0.949em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1000.76em, 2.714em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-907"><span class="mi" id="MathJax-Span-908" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-118">G</script> is an undirected graph. Let <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-119-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-909" style="width: 2.462em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.021em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1001.96em, 2.904em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-910"><span class="mi" id="MathJax-Span-911" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-912" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-913" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-914" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-915" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-119">dp[i]</script> be the number of ways of construct a DAG with vertex set of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-916" style="width: 0.381em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.318em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.706em, 1000.25em, 2.714em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-917"><span class="mi" id="MathJax-Span-918" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-120">i</script>, and a boolean array <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-919" style="width: 2.967em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.399em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1002.34em, 2.904em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-920"><span class="mi" id="MathJax-Span-921" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-922" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-923" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-924" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-925" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-926" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mi>u</mi><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-121">jud[i]</script> represent that if the set <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-927" style="width: 0.381em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.318em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.706em, 1000.25em, 2.714em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-928"><span class="mi" id="MathJax-Span-929" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-122">i</script> doesn't contain any edges that connect them(which means if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-930" style="width: 2.588em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.084em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.706em, 1002.02em, 2.714em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-931"><span class="mi" id="MathJax-Span-932" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-933" style="font-family: STIXGeneral; padding-left: 0.318em;"></span><span class="mi" id="MathJax-Span-934" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.318em;"></span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mo></mo><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-123">u\in i</script>,<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-124-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-935" style="width: 2.651em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.147em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.706em, 1002.08em, 2.714em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-936"><span class="mi" id="MathJax-Span-937" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-938" style="font-family: STIXGeneral; padding-left: 0.318em;"></span><span class="mi" id="MathJax-Span-939" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.318em;"></span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><mo></mo><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-124">v\in i</script> and there is an edge connected <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-940" style="width: 0.634em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.508em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.895em, 1000.51em, 2.714em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-941"><span class="mi" id="MathJax-Span-942" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-125">u</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-126-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-943" style="width: 0.634em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.508em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.895em, 1000.51em, 2.714em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-944"><span class="mi" id="MathJax-Span-945" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-126">v</script>, then <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-127-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-946" style="width: 5.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.165em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1004.16em, 2.904em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-947"><span class="mi" id="MathJax-Span-948" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-949" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-950" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-951" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-952" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-953" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-954" style="font-family: STIXGeneral; padding-left: 0.318em;">=</span><span class="mn" id="MathJax-Span-955" style="font-family: STIXGeneral; padding-left: 0.318em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mi>u</mi><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-127">jud[i]=0</script>, otherwise <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-128-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-956" style="width: 5.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.165em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1004.04em, 2.904em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-957"><span class="mi" id="MathJax-Span-958" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-959" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-960" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-961" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-962" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-963" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-964" style="font-family: STIXGeneral; padding-left: 0.318em;">=</span><span class="mn" id="MathJax-Span-965" style="font-family: STIXGeneral; padding-left: 0.318em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mi>u</mi><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-128">jud[i]=1</script>).</p><p>Consider the method to calculate the array <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-129-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-966" style="width: 2.462em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.021em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1001.96em, 2.904em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-967"><span class="mi" id="MathJax-Span-968" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-969" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-970" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-971" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-972" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-129">dp[i]</script>. We can enumerate the vertex set <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-130-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-973" style="width: 0.381em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.318em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.706em, 1000.25em, 2.714em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-974"><span class="mi" id="MathJax-Span-975" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-130">i</script>. As <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-131-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-976" style="width: 0.381em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.318em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.706em, 1000.25em, 2.714em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-977"><span class="mi" id="MathJax-Span-978" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-131">i</script> is an vertex set of a DAG, there must be some vertexes with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-132-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-979" style="width: 0.634em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.508em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1000.51em, 2.714em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-980"><span class="mn" id="MathJax-Span-981" style="font-family: STIXGeneral;">0</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-132">0</script> in-degree. Then enumerating a vertex set <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-133-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-982" style="width: 0.508em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.381em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.706em, 1000.38em, 2.904em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-983"><span class="mi" id="MathJax-Span-984" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-133">j</script> which is a subset of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-134-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-985" style="width: 0.381em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.318em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.706em, 1000.25em, 2.714em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-986"><span class="mi" id="MathJax-Span-987" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-134">i</script>, and let all the vertexes in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-988" style="width: 0.508em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.381em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.706em, 1000.38em, 2.904em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-989"><span class="mi" id="MathJax-Span-990" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-135">j</script> have <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-136-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-991" style="width: 0.634em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.508em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1000.51em, 2.714em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-992"><span class="mn" id="MathJax-Span-993" style="font-family: STIXGeneral;">0</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-136">0</script> in-degree. Obviously <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-137-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-994" style="width: 5.236em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.291em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1004.29em, 2.904em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-995"><span class="mi" id="MathJax-Span-996" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-997" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-998" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-999" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-1000" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-1001" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-1002" style="font-family: STIXGeneral; padding-left: 0.318em;">=</span><span class="mn" id="MathJax-Span-1003" style="font-family: STIXGeneral; padding-left: 0.318em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mi>u</mi><mi>d</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-137">jud[j]=0</script> (if it exists an edge connected vertexes of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-138-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1004" style="width: 0.508em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.381em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.706em, 1000.38em, 2.904em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-1005"><span class="mi" id="MathJax-Span-1006" style="font-family: STIXGeneral; font-style: italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-138">j</script>, then there must be an edge with nonzero in-degree). But it may calculate a same method more than once, so we need calculate it by inclusion-exclusion principle.</p> <center><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-139-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2295;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1007" style="width: 16.838em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.811em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.516em, 1013.75em, 3.156em, -999.997em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-1008"><span class="mi" id="MathJax-Span-1009" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-1010" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-1011" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-1012" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-1013" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-1014" style="font-family: STIXGeneral; padding-left: 0.318em;">=</span><span class="munderover" id="MathJax-Span-1015" style="padding-left: 0.318em;"><span style="display: inline-block; position: relative; width: 3.282em; height: 0px;"><span style="position: absolute; clip: rect(3.03em, 1000.89em, 4.417em, -999.997em); top: -3.969em; left: 0em;"><span class="mo" id="MathJax-Span-1016" style="font-family: STIXGeneral; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span><span style="position: absolute; top: -3.654em; left: 0.886em;"><span class="texatom" id="MathJax-Span-1017"><span class="mrow" id="MathJax-Span-1018"><span class="mi" id="MathJax-Span-1019" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-1020" style="font-size: 70.7%; font-family: STIXGeneral;"></span><span class="mi" id="MathJax-Span-1021" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-1022" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-1023" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-1024" style="font-size: 70.7%; font-family: STIXGeneral;"></span><span class="mn" id="MathJax-Span-1025" style="font-size: 70.7%; font-family: STIXGeneral;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span></span></span><span class="mo" id="MathJax-Span-1026" style="font-family: STIXGeneral;">(</span><span class="mo" id="MathJax-Span-1027" style="font-family: STIXGeneral;"></span><span class="mn" id="MathJax-Span-1028" style="font-family: STIXGeneral;">1</span><span class="msubsup" id="MathJax-Span-1029"><span style="display: inline-block; position: relative; width: 1.958em; height: 0px;"><span style="position: absolute; clip: rect(3.093em, 1000.32em, 4.354em, -999.997em); top: -3.969em; left: 0em;"><span class="mo" id="MathJax-Span-1030" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span><span style="position: absolute; top: -4.347em; left: 0.318em;"><span class="texatom" id="MathJax-Span-1031"><span class="mrow" id="MathJax-Span-1032"><span class="texatom" id="MathJax-Span-1033"><span class="mrow" id="MathJax-Span-1034"><span class="mo" id="MathJax-Span-1035" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span></span><span class="mi" id="MathJax-Span-1036" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;"></span><span class="texatom" id="MathJax-Span-1037"><span class="mrow" id="MathJax-Span-1038"><span class="mo" id="MathJax-Span-1039" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span></span><span class="mo" id="MathJax-Span-1040" style="font-size: 70.7%; font-family: STIXGeneral;">+</span><span class="mn" id="MathJax-Span-1041" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.975em;"></span></span></span></span><span class="mi" id="MathJax-Span-1042" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mi" id="MathJax-Span-1043" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-1044" style="font-family: STIXGeneral;">[</span><span class="mi" id="MathJax-Span-1045" style="font-family: STIXGeneral; font-style: italic;"></span><span class="mo" id="MathJax-Span-1046" style="font-family: STIXGeneral; padding-left: 0.255em;"></span><span class="mi" id="MathJax-Span-1047" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.255em;"></span><span class="mo" id="MathJax-Span-1048" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.525em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.612em; border-left: 0px solid; width: 0px; height: 1.696em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><munder><mo></mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo></mo><mi>i</mi><mo>,</mo><mi>j</mi><mo></mo><mn>0</mn></mrow></munder><mo stretchy="false">(</mo><mo></mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>j</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn></mrow></msup><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo></mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-139"> dp[i]=\sum_{j\in i,j\neq 0}(-1)^{|j|+1}dp[i\oplus j] </script></center><p>Excuse my poor English...XD. Here is my <a href="https://codeforces.com/contest/1193/submission/57916473">code</a>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530893 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530893 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530893">
            <li>
<div class="comment">
    <table class="comment-table" commentid="530898" commentparentid="530893">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/chenyanbo" style="position: relative;">
<img src="./ceoi-day2_files/63c4c5820ef50068.jpg">        </a>
        <div><a href="https://codeforces.com/profile/chenyanbo" title="Candidate Master chenyanbo" class="rated-user user-violet">chenyanbo</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/28/2019 11:45 UTC-7">24 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530898" href="https://codeforces.com/blog/entry/68748?#comment-530898" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530893" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530898" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530898" data-commentrating="3" data-commentuserid="549470">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530898">
                    <div class="moveup">
                    <div class="ttypography"><p>But why time complexity is O(3^n)? I know it is right because it runs like O(3^n), but I can't prove it.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530898 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530898 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530898">
            <li>
<div class="comment">
    <table class="comment-table" commentid="530902" commentparentid="530898">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/oleh1421" style="position: relative;">
<img src="./ceoi-day2_files/no-avatar.jpg">        </a>
        <div><a href="https://codeforces.com/profile/oleh1421" title="Expert oleh1421" class="rated-user user-blue">oleh1421</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/28/2019 13:55 UTC-7">22 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530902" href="https://codeforces.com/blog/entry/68748?#comment-530902" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530898" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530902" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530902" data-commentrating="10" data-commentuserid="850909">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+10</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530902">
                    <div class="moveup">
                    <div class="ttypography"><p>Well it's actually not so hard to proof. Let's do this: If we have a set with x elements then the number of subsets is going to be 2^x. So the sum of the number of subsets of all sets is: C(0,n)*2^0+C(1,n)*2^1+C(2,n)*2^2+...+C(n,n)*2^n=(2+1)^n=3^n(Binomial coefficient)</p><p>Sorry for my English</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530902 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530902 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530902">
            <li>
<div class="comment">
    <table class="comment-table" commentid="530929" commentparentid="530902">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                        <div class="comment-no-indent">
                            <span></span>
                        </div>
                </div>
    <div class="avatar">
        <a href="https://codeforces.com/profile/Paulliant" style="position: relative;">
<img src="./ceoi-day2_files/5f3d8228e272ae38.jpg">        </a>
        <div><a href="https://codeforces.com/profile/Paulliant" title="Expert Paulliant" class="rated-user user-blue">Paulliant</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/28/2019 17:37 UTC-7">18 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-530929" href="https://codeforces.com/blog/entry/68748?#comment-530929" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="https://codeforces.com/blog/entry/68748#comment-530902" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="COMMENT" data-entityid="530929" data-size="12" src="./ceoi-day2_files/star_gray_12.png">
    </span>

</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="530929" data-commentrating="7" data-commentuserid="828844">
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="./ceoi-day2_files/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+7</span></span>
<a href="https://codeforces.com/blog/entry/68748#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="./ceoi-day2_files/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-530929">
                    <div class="moveup">
                    <div class="ttypography"><p>That's it.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-530929 en false" href="https://codeforces.com/blog/entry/68748#" style="text-decoration: none;"><span class="arrow"></span></a>
                    <a class="comment-530929 en false" href="https://codeforces.com/blog/entry/68748#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-530929">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
    <br>

<div id="editBox-73371" style="width:50em;display:none;">
    <div class="previewBody" style="border: 1px solid #d4d4d4; margin-bottom: 0.5em; padding: 0.25em; display:none;">&nbsp;</div>
    <div style="width: 1px">&nbsp;</div>
    <div class="commentLocale" style="position: relative; top: 0.5em;left:4px;display: none;">
        <input type="radio" name="locale" value="en"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In English</span>
        <input style="margin-left:1em" type="radio" name="locale" value="ru"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In Russian</span>
    </div>
    <textarea data-drafts-id="CommentReplyFrame" class="wysiwyg" name="editContent" rows="20" style="width:99%;"></textarea>
    <div class="error error__content"></div>
    <div style="text-align:center;">
        <input type="button" name="preview" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Preview">
        <input type="button" name="save" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Save">
    </div>
</div>

    <script type="text/javascript">
        $(document).ready(function () {

var firstPreview73371 = true;
var lastPreviewContent73371 = '';

if (!window.moveCommentRevision) {
    moveCommentRevision = function(e, dir) {
        var p = e.parent();
        var revisionCount = parseInt(p.attr("revisionCount"));
        var revision = parseInt(p.attr("revision"));
        var next = revision + dir;
        var commentId = p.attr("commentId");
        if (next >= 1 && next <= revisionCount) {
            $.post(
                "/data/comment-data",
                {action: "revision", commentId: commentId, revision: next},
                function(json) {
                    if (json.success == "true") {
                        var parentDiv = e;

                        while (parentDiv !== null && (parentDiv[0].nodeName.toLowerCase() !== "td" || !parentDiv.hasClass("right"))) {
                            parentDiv = parentDiv.parent();
                        }

                        if (parentDiv === null) {
                            return;
                        }

                        parentDiv.find("div.comment-content-" + commentId + " .moveup").html(json.content);
                        Codeforces.setupSpoilers(parentDiv.find("div.comment-content-" + commentId + " .moveup"));
                        p.attr("revision", next);
                        p.find("span.revision").text(next);
                        if (next == 1) {
                            p.find("a.leftRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.leftRevision").css("visibility", "visible");
                        }
                        if (next == revisionCount) {
                            p.find("a.rightRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.rightRevision").css("visibility", "visible");
                        }

                        window.updateTypography();
                        MathJax.Hub.Typeset();
                    } else {
                        alert(e.error);
                    }
                },
                "json"
            );
        }
    };
}

$("div[commentableId=73371] a.leftRevision").click(function () {
    window.moveCommentRevision($(this), -1);
    return false;
});

$("div[commentableId=73371] a.rightRevision").click(function () {
    window.moveCommentRevision($(this), +1);
    return false;
});

    $("div[commentableId=73371] a.editCommentLink").click(function () {
        if (confirm("You may edit your comment only for fixing grammar mistakes or small changes. Do not change the main idea of your comment. All previous revisions are available for others. Are you sure you want to edit comment?")) {
            Codeforces.facebox("#editBox-73371", "//sta.codeforces.com/s/16651");
            firstPreview73371 = true;
            lastPreviewContent73371 = '';
            $("#facebox #editBox-73371 textarea.wysiwyg").drafts({textDrafts: "Drafts", textUseIt: "Use it", url: "/data/draft", saveErrorMessage: "Can't save draft. Possibly connection is lost or session is expired. Stay on the page (cancel to reload)?"});
            var commentId = $(this).attr("commentId");
            $.post("/data/comment-data", {action: "content", commentId: commentId}, function(json) {
                if (json["success"] != "true") {
                    alert(json["error"]);
                    return;
                }
                var content = json["content"];
                $("#facebox #editBox-73371 textarea.wysiwyg").val(content);

                if (json["allowChangeLocale"] == "true") {
                    $("#facebox #editBox-73371 .commentLocale").css("display", "");
                }

                var commentLocale = json["commentLocale"];
                if (commentLocale == "en") {
                    $("#facebox #editBox-73371 .commentLocale input[value=en]").prop("checked", true);
                } else {
                    $("#facebox #editBox-73371 .commentLocale input[value=ru]").prop("checked", true);
                }

                $("#facebox #editBox-73371 textarea.wysiwyg").css("width", "97%").markItUp(commentSettings).css("height", "200px");

                $("#facebox #editBox-73371 input[name='save']").click(function () {
                    var content = $("#facebox #editBox-73371 textarea.wysiwyg").val();
                    var locale = $("#facebox #editBox-73371 input[name=locale]:checked").val();
                    $.post(
                        "/data/comment-data",
                        {action: "update", commentId: commentId, content: content, locale: locale, subscribedCommentLinkInfix: "VcWWzn4lfXSagllJfB9SbeHeQng*/blog/entry/68748"},
                        function(json) {
                            if (json.success == "true") {
                                Codeforces.reload();
                            } else {
                                $("#facebox #editBox-73371 div.error__content").text(json.error__content);
                                window.updateTypography();
                            }
                        },
                        "json"
                    );

                    return false;
                });

                $("#facebox #editBox-73371 input[name='preview']").click(function () {
                    var content = $("#facebox #editBox-73371 textarea[name='editContent']").val();
                    if (firstPreview73371 || lastPreviewContent73371 != content) {
                        firstPreview73371 = false;
                        lastPreviewContent73371 = content;
                        commentPreviewShow73371(commentId);
                    }
                    return false;
                });
            }, "json");
        }
        return false;
    });

    var commentPreviewShow73371 = function(commentId) {
        var content = $("#facebox #editBox-73371 textarea[name='editContent']").val();
        var replyLocale = $("#facebox #editBox-73371 input[name=locale]:checked").val();
        $.post(
        "/data/comment-data", {action: "preview", replyLocale: replyLocale, content: content, commentId: commentId},
            function(json) {
                if (json.success == "true") {
                    $("#facebox #editBox-73371 .previewBody").html("<div style='font-size: 1.2rem;'>Comment preview:<hr/></div><div class='comment-content' style='position: relative; bottom: 12px;'>" + json.response + "</div>").fadeIn();
                    Codeforces.setupSpoilers($("#facebox #editBox-73371 .previewBody"));
                    MathJax.Hub.Typeset();
                } else {
                    $("#facebox #editBox-73371 .previewBody").html("<div><b style='color:red;'>Comment preview error:</b><hr/><div>" + json.error__content).fadeIn();
                }
                window.updateTypography();
            },
            "json"
        );
        return false;
    };

    $("div[commentableId=73371] a.deleteCommentLink").click(function () {
        if (confirm("Are you sure you want to delete this comment?")) {
            var commentId = $(this).attr("commentId");
            $.post("/data/comment-data", {action: "delete", commentId: commentId}, function(json) {
                if (json.success == "true") {
                    Codeforces.reload();
                } else {
                    alert(json.error);
                }
            }, "json");
        }
        return false;
    });

        });
    </script>

<div class="comment comment-reply-prototype" style="display:none;">
        <table class="comment-table" style="width: 100%;">
            <tbody><tr>
                <td class="left">
    <div class="avatar">
        <a href="https://codeforces.com/profile/mostafa.saad.fci" style="position: relative;">
<img src="./ceoi-day2_files/27d8267229d63351.jpg">        </a>
        <div><a href="https://codeforces.com/profile/mostafa.saad.fci" title="Expert mostafa.saad.fci" class="rated-user user-blue">mostafa.saad.fci</a></div>
    </div>
                </td>
                <td class="right" style="padding:1em 0 1em 1em;">
                    <form action="https://codeforces.com/blog/entry/68748" method="post" class="commentReplyForm"><input type="hidden" name="csrf_token" value="a400a051aa98a0c1e1e5c21297bdc579">
                        <input type="hidden" name="commentReplyFormSubmitted" value="true">
                        <input type="hidden" name="commentId">
                        <input type="hidden" name="hasMaximalDepth">
                        <input type="hidden" name="commentableId">
                        <table class="table-form" style="width:100%;">
                            <tbody><tr>
                                <td style="width: 1px">&nbsp;</td><td>
                                <div style="position: relative; top: 0.5em;left:4px;">
                                    <input type="radio" name="locale" value="en"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In English</span>
                                    <input style="margin-left:1em" type="radio" name="locale" value="ru"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In Russian</span>
                                </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 1px;">&nbsp;</td><td>
                                    <div class="previewBody" style="border: 1px solid #d4d4d4; margin-bottom: 0.5em; padding: 0.25em; display:none;">&nbsp;</div>
                                    <textarea data-drafts-id="CommentReplyFrame" class="no-wysiwyg" name="replyContent" rows="10" style="width: 100%;"></textarea>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" valign="top">
                                    <div style="float: left;" class="small">
         <div class="shiftUp error__commentWithId">
             <span class="error for__commentWithId " style="display: none;">&nbsp;</span>
             <span class="notice for__commentWithId ">&nbsp;</span>
         </div>
         <div class="shiftUp error__content">
             <span class="error for__content " style="display: none;">&nbsp;</span>
             <span class="notice for__content ">&nbsp;</span>
         </div>
                                    </div>
                                    <div style="position: relative; right: 4px;text-align:right;">
                                        <div style="position: relative; display: inline-block;">
                                            <img style="left:-24px;" class="ajax-loading-gif" src="./ceoi-day2_files/ajax-loading-16x16.gif">
                                            <input style="font-size: 0.7em;height:1.8em;padding:0 0.75em;" type="submit" name="submit" value="Post">
                                            <input style="font-size: 0.7em;height:1.8em;padding:0 0.75em;" type="button" class="preview" value="Preview">
                                            <input style="font-size: 0.7em;height:1.8em;padding:0 0.75em;" type="button" class="cancel" value="Cancel">
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody></table>
                    <input type="hidden" name="_tta" value="187"></form>
                </td>
            </tr>
        </tbody></table>
</div>

        <script type="text/javascript">
            $(function() {
                window._ftaa = "onlhahszznugw8tidc";
            })
        </script>

        <script type="text/javascript">
            $(function() {
                window._bfaa = "e6815c60765c03ed71126cfaedf936d3";
            });
        </script>

    <script type="text/javascript">
        $(document).ready(function () {
    var commentPreviewListener = function(div) {
        var content = div.find("textarea").val();
        var replyLocale = div.find('input[name=locale]:checked').val();

        $.post(
            "/data/comment-data",
            {action: "preview", replyLocale: replyLocale, content: content},
            function(json) {
                if (json.success == "true") {
                    div.find(".previewBody").html("<div style='font-size: 1.2rem;'>Comment preview:<hr/></div><div class='comment-content' style='position: relative; bottom: 12px;'>" + json.response + "</div>").fadeIn();
                    Codeforces.setupSpoilers(div.find(".previewBody"));
                    MathJax.Hub.Typeset();
                } else {
                    div.find(".previewBody").html("<div><b style='color:red;'>Comment preview error:</b><hr/><div>" + json.error__content).fadeIn();
                }
                window.updateTypography();
            },
            "json"
        );

        return false;
    }

    var commentReplyFormSubmitListener = function () {
        var id = $(this).attr("id");
        var hasMaximalDepth = $(this).find("input[name=hasMaximalDepth]").val() || "false";
        var commentWithId = $(this).find("input[name=commentId]").val() || "";
        var content = $(this).find("textarea").val();
        var commentableId = $(this).find("input[name=commentableId]").val() || 0;
        var commentReplyFormSubmitted = $(this).find("input[name=commentReplyFormSubmitted]").val();
        var replyLocale = $(this).find('input[name=locale]:checked').val();

        var postNewCommentReply = function () {
            $.post(
                "/data/new-comment-reply",
                {ftaa: window._ftaa, bfaa: window._bfaa, commentWithId:     commentWithId, content: content, commentReplyFormSubmitted: commentReplyFormSubmitted, _tta: Codeforces.tta(), replyLocale: replyLocale, commentableId: commentableId, subscribedCommentLinkInfix: "VcWWzn4lfXSagllJfB9SbeHeQng*/blog/entry/68748"},
                function(data) {
                    var invalid = Codeforces.setAjaxFormErrors("#" + id , data);
                    var newCommentWithId = data.newCommentWithId;
                    if (!invalid) {
                        var s = window.location.toString();
                        var found = false;
                        for (var i = 0; i < s.length; i++)
                            if (s.charAt(i) == '#') {
                                found = true;
                                index = i;
                            }
                        if (!found) {
                            s += "#" + newCommentWithId;
                        } else {
                            s = s.substr(0, index + 1) + newCommentWithId;
                        }
                        window.location = s;
                        window.location.reload();
                    }
                },
                "json"
            );
        };

        $.post("/data/checkTextForRussianLanguage", { text: content }, function(response) {
            var isRussianComment = response["isRussianComment"];
            if (replyLocale == "en" && isRussianComment == "true") {
                Codeforces.confirm(
                    "Are you sure that your comment in English?",
                    postNewCommentReply, function () { },
                    "Yes", "No"
                );
            } else if (replyLocale == "ru" && isRussianComment == "false") {
                Codeforces.confirm(
                    "Are you sure that your comment in Russian?",
                    postNewCommentReply, function () { },
                    "Yes", "No"
                );
            } else {
                postNewCommentReply();
            }
        }, "json");

        return false;
    }
    $("a.new-root-comment").click(function () {
            var a = $(this);
            a.hide();

            var commentableId = $(".comments").attr("commentableId");
            var e = $(".comment-reply-prototype").clone().removeClass("comment-reply-prototype");

            var div = $("<div></div>").append(e);
            var p = $(this).parent();
            p.prepend(div);
            e.show();

            e.find("input[value=en]").attr("checked", true);
            e.find("input[name=commentableId]").attr("value", commentableId);
            e.find("form").submitOnce(commentReplyFormSubmitListener, true);
            e.find("form").attr("id", "form-" + (new Date().getTime()));

            div.find('textarea.no-wysiwyg').css("width", "97%").markItUp(commentSettings).css("height", "200px");
            div.find('textarea.no-wysiwyg').removeClass("no-wysiwyg");
            div.find('textarea').drafts({textDrafts: "Drafts", textUseIt: "Use it", url: "/data/draft", saveErrorMessage: "Can't save draft. Possibly connection is lost or session is expired. Stay on the page (cancel to reload)?"});

            var first = true;
            div.find(".cancel").each(function () {
                if (first) {
                    $(this).click(function () {
                        div.remove();
                        a.show();
                        return false;
                    });
                    first = false;
                }
            });

            first = true;
            div.find(".preview").each(function () {
                if (first) {
                    $(this).click(function () {
                        commentPreviewListener(div);
                        return false;
                    });
                    first = false;
                }
            });
        return false;
    });

    $(".comment-table .reply a").click(function () {
            var classes = this.className.split(" ");
            var commentId = classes[0];
            var locale = classes[1];
            var hasMaximalDepth = classes[2];
            var commentableId = $(".comments").attr("commentableId");

            showReplyWindow = function () {
                $(".current-comment-reply").remove();
                var e = $(".comment-reply-prototype").clone().removeClass("comment-reply-prototype").addClass("current-comment-reply");

                var li = $("<li></li>").append(e);
                var ul = $(".comment ul." + commentId);
                ul.prepend(li);
                e.show();
                e.find("input[name=commentId]").attr("value", commentId);
                e.find("input[name=hasMaximalDepth]").attr("value", hasMaximalDepth);
                e.find("input[value=" + locale + "]").attr("checked", true);
                e.find("input[name=locale]").attr("readonly", true);
                e.find("input[name=locale]").attr("disabled", true);
                e.find("input[name=commentableId]").attr("value", commentableId);
                e.find("form").submitOnce(commentReplyFormSubmitListener, true);
                e.find("form").attr("id", "form-" + (new Date().getTime()));

                li.find('textarea').css("width", "97%").markItUp(commentSettings).css("height", "200px");

                setTimeout(function () {
                    li.find('textarea').drafts({textDrafts: "Drafts", textUseIt: "Use it", url: "/data/draft", saveErrorMessage: "Can't save draft. Possibly connection is lost or session is expired. Stay on the page (cancel to reload)?"});
                }, 1000);

                var first = true;
                ul.find(".cancel").each(function () {
                    if (first) {
                        $(this).click(function () {
                            li.remove();
                            return false;
                        });
                        first = false;
                    }
                });

                first = true;
                ul.find(".preview").each(function () {
                    if (first) {
                        $(this).click(function () {
                            commentPreviewListener(ul);
                        });
                        first = false;
                    }
                });
            }

            if (hasMaximalDepth == "true") {
                Codeforces.confirm("The debates reached maximal permitted depth, so your message and the message you are replying will be displayed on the same level. Are you sure you want to reply to the message?", showReplyWindow, function () { }, "Yes", "No");
            } else {
                showReplyWindow();
            }
        return false;
    });
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
    $(".vote-for-comment").mouseover(function () {
        var vote = $(this);
        var direction = vote.attr("voteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = commentUserId==1752;
        if (direction == 1 && !ownComment) {
            vote.find("img").attr("src", "//sta.codeforces.com/s/16651/images/actions/comment-voteup.png");
            vote.find("img").attr("popacity", vote.find("img").css("opacity"));
            vote.find("img").css("opacity", "1.0");
        }
        if (direction == -1 && !ownComment) {
            vote.find("img").attr("src", "//sta.codeforces.com/s/16651/images/actions/comment-votedown.png");
            vote.find("img").attr("popacity", vote.find("img").css("opacity"));
            vote.find("img").css("opacity", "1.0");
        }
    });

    $(".vote-for-comment").mouseout(function () {
        var vote = $(this);
        var direction = vote.attr("voteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = commentUserId==1752;
        if (direction == 1 && !ownComment) {
            vote.find("img").attr("src", "//sta.codeforces.com/s/16651/images/actions/comment-voteup-blue.png");
            vote.find("img").css("opacity", vote.find("img").attr("popacity"));
        }
        if (direction == -1 && !ownComment) {
            vote.find("img").attr("src", "//sta.codeforces.com/s/16651/images/actions/comment-votedown-blue.png");
            vote.find("img").css("opacity", vote.find("img").attr("popacity"));
        }
    });

    $(".vote-for-comment").click(function () {
        var vote = $(this);
        var commentId = $(this).parent().attr("commentid");
        var commentRating = $(this).parent().attr("data-commentRating");
        var direction = $(this).attr("voteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = commentUserId==1752;
        $.post("/data/comment/vote", {commentId: commentId, _tta: Codeforces.tta(), vote: direction, commentRating: commentRating}, function(data) {
            if (direction != 0 && !ownComment && data["success"] == "true") {
                vote.parent().find(".vote-for-comment").attr("voteDirection", 0);
                if (direction == 1)
                    vote.find("img").attr("src", "//sta.codeforces.com/s/16651/images/actions/comment-voteup.png");
                else
                    vote.find("img").attr("src", "//sta.codeforces.com/s/16651/images/actions/comment-votedown.png");
                vote.find("img").attr("popacity", "1.0");
                vote.find("img").css("opacity", "1.0");
                vote.parent().find(".commentRating").html(data["commentRating"]);
            }
            Codeforces.showMessage(data["message"]);
        }, "json");
        return false;
    });

    $(".negative-comment-vote").closest(".comment-table").addClass("comment-bad");

    $(".troll-comment-vote").closest(".comment").css("display", "none");

    $(".too-negative-comment-vote").closest(".comment-table").each(function () {
        var e = $(this);
        e.addClass("comment-too-bad");
        var commentId = e.attr("commentId");
        $("<div class='bad-comment-replacement ttypography'>The comment is hidden because of too negative feedback, click <a href=# class=show-bad-comment-link>here</a> to view it</div>").appendTo(
            e.find(".right")
        );
        e.find(".comment-content").hide();
        e.find(".show-bad-comment-link").click(function () {
            e.find(".comment-content").show();
            e.find(".bad-comment-replacement").hide();
            return false;
        });
    });
        });
    </script>
</div>

<style type="text/css">
    .new-comments-box {
        padding: 0.5em;
        width: 22px;
        font-size: 1.3rem;
        font-weight: bold !important;

        position: fixed;
        top: 40%;
        right: 0;
        opacity: 0.2;
        color: white;
        text-align: center;

        border: 1px solid #222;
        background-color: #888 !important;
        border-radius: 3px;
        -moz-border-radius: 3px;
        -webkit-border-radius: 3px;
    }

    .new-comments-box:hover {
        opacity: 1;
    }

    .new-comments-box .dir:hover {
        background: #3B5998 !important;
        cursor: pointer;
    }
</style>

<div class="new-comments-box" data-position="outside" data-index="-1" style="display: none;">
    <div class="up dir" title="Ctrl+Up"><hr></div>
    <div class="info" title="New comments"></div>
    <div class="down dir" title="Ctrl+Down"><hr></div>
</div>

    <script type="text/javascript">
        $(document).ready(function () {
    function gotoComment(direction) {
        var box = $(".new-comments-box");
        var index = parseInt(box.attr("data-index"));
        if (index == -1)
            index = 0;
        else
            index = Math.max(0, Math.min(parseInt(box.find(".info").text()) - 1, index + direction));
        box.attr("data-index", index);
        var comment = $($(".comment .highlight-blue[commentId]").get(index));
        $('html, body').animate({
          'scrollTop': Math.max(0, comment.offset().top - ($(window).height() - comment.height()) / 2)
        });
        return false;
    }

    $(".new-comments-box .down").click(function () {
        return gotoComment(1);
    });

    $(".new-comments-box .up").click(function () {
        return gotoComment(-1);
    });

    $(document).keydown(function (e) {
         var code = (e.keyCode ? e.keyCode : e.which);
         if (e.ctrlKey) {
            if (code == 38 || code == 40) {
                gotoComment(code - 39);
            }
         }
    });

    var newCommentCount = $(".comment .highlight-blue[commentId]").length;
    if (newCommentCount > 0) {
        $(".new-comments-box .info").text(newCommentCount);
        $(".new-comments-box").show();
    }

    $('table.comment-table').mouseenter(function () {
        var comment = $(this);
        var cnt = 0;
        while (true) {
            var id = comment.attr("commentId");
            var parentId = comment.attr("commentParentId");
            comment.find(".comment-indent-holder:first .comment-no-indent").addClass("comment-indent");
            if (parentId == -1) {
                break;
            }
            comment = $("table.comment-table[commentId=" + parentId + "]");
        }
        return false;
    });

    $('table.comment-table').mouseleave(function () {
        var comment = $(this);
        var cnt = 0;
        while (true) {
            var id = comment.attr("commentId");
            var parentId = comment.attr("commentParentId");
            comment.find(".comment-indent-holder:first .comment-no-indent").removeClass("comment-indent");
            if (parentId == -1) {
                break;
            }
            comment = $("table.comment-table[commentId=" + parentId + "]");
        }
        return false;
    });
        });
    </script>


    <script type="text/javascript">
        $(document).ready(function () {
    $(".topic-vote-up-69219").click(function () {
        $.post("/data/topic/vote", {topicId: 69219, _tta: Codeforces.tta(), topicRevisionId: 164538, vote: +1}, function(data) {
            Codeforces.showMessage(data);
        }, "json");
        return false;
    });
    $(".topic-vote-down-69219").click(function () {
        $.post("/data/topic/vote", {topicId: 69219, _tta: Codeforces.tta(), topicRevisionId: 164538, vote: -1}, function(data) {
            Codeforces.showMessage(data);
        }, "json");
        return false;
    });
        });
    </script>
</div>
        </div>
    </div>
                </div>
        </div>
            <br style="clear: both;">
            <div id="footer">
                <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2019 Mike Mirzayanov</div>
                <div>The only programming contests Web 2.0 platform</div>
                    <div>Server time: Jul/29/2019 21:51:12<sup title="timezone offset" style="font-size:8px;">UTC-7</sup> (f1).</div>
                    <div>Desktop version, switch to <a rel="nofollow" class="switchToMobile" href="https://codeforces.com/blog/entry/68748?mobile=true">mobile version</a>.</div>
                <div class="smaller"><a href="https://codeforces.com/privacy">Privacy Policy</a></div>

                    <div style="margin-top: 25px;">
                        Supported by
                    </div>
                    <div style="margin-top: 8px; padding-bottom: 20px; position: relative; left: 10px;">
                        <a href="https://telegram.org/"><img style="margin-right: 2em; width: 60px;" src="./ceoi-day2_files/telegram-100x100.png" alt="Telegram" title="Telegram"></a>
                        <a href="http://ifmo.ru/en/"><img style="width: 120px;" src="./ceoi-day2_files/itmo_small_en-logo.png" alt="" title=""></a>
                    </div>
            </div>
        <script type="text/javascript">
            $(function() {
                $(".switchToMobile").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "true"));
                    return false;
                });
                $(".switchToDesktop").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "false"));
                    return false;
                });
            });
        </script>
    <script type="text/javascript">
        $(document).ready(function () {
            if ($(window).width() < 1600) {
                $('.button-up').css('width', '30px').css('line-height', '30px').css('font-size', '20px');
            }

            if ($(window).width() >= 1200) {
                $ (window).scroll (function () {
                    if ($ (this).scrollTop () > 100) {
                        $ ('.button-up').fadeIn();
                    } else {
                        $ ('.button-up').fadeOut();
                    }
                });

                $('.button-up').click(function () {
                    $('body,html').animate({
                        scrollTop: 0
                    }, 500);
                    return false;
                });

                $('.button-up').hover(function () {
                    $(this).animate({
                        'opacity':'1'
                    }).css({'background-color':'#e7ebf0','color':'#6a86a4'});
                }, function () {
                    $(this).animate({
                        'opacity':'0.7'
                    }).css({'background':'none','color':'#d3dbe4'});;
                });
            }
            Codeforces.focusOnError();
        });
    </script>

        <div class="userListsFacebox" style="display:none;">
            <div style="padding: 0.5em; width: 600px; max-height: 200px; overflow-y: auto">
<div class="datatable" style="background-color: #E1E1E1; padding-bottom: 3px;">
            <div class="lt">&nbsp;</div>
            <div class="rt">&nbsp;</div>
            <div class="lb">&nbsp;</div>
            <div class="rb">&nbsp;</div>

            <div style="padding: 4px 0 0 6px;font-size:1.4rem;position:relative;">
                User lists

                <div style="position:absolute;right:0.25em;top:0.35em;">
                    <span style="padding:0;position:relative;bottom:2px;" class="rowCount"></span>

                    <img class="closed" src="./ceoi-day2_files/control.png">

                    <span class="filter" style="display:none;">
                        <img class="opened" src="./ceoi-day2_files/control-270.png">
                        <input style="padding:0;position:relative;bottom:2px;border:1px solid #aaa;height:17px;font-size:1.3rem;">
                    </span>
                </div>
            </div>
            <div style="background-color: white;margin:0.3em 3px 0 3px;position:relative;">
            <div class="ilt">&nbsp;</div>
            <div class="irt">&nbsp;</div>
            <table class="">
                    <thead>
                    <tr>
                        <th class="top left right">Name</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr class="no-items visible"><td style="text-align:left;" colspan="32" class="bottom dark left right">No items</td></tr></tbody>
            </table>
            </div>
        </div>
    <script type="text/javascript">
        $(document).ready(function () {
                // Create new ':containsIgnoreCase' selector for search
                jQuery.expr[':'].containsIgnoreCase = function(a, i, m) {
                    return jQuery(a).text().toUpperCase()
                            .indexOf(m[3].toUpperCase()) >= 0;
                };

                if (window.updateDatatableFilter == undefined) {
                    window.updateDatatableFilter = function(i) {
                        var parent = $(i).parent().parent().parent().parent();
                        $("tr.no-items", parent).remove();
                        $("tr", parent).hide().removeClass('visible');
                        var text = $(i).val();
                        if (text) {
                            $("tr" + ":containsIgnoreCase('" + text + "')", parent).show().addClass('visible');
                        } else {
                            parent.find(".rowCount").text("");
                            $("tr", parent).show().addClass('visible');
                        }

                        var found = false;
                        var visibleRowCount = 0;
                        $("tr", parent).each(function () {
                            if (!found) {
                                if ($(this).find("th").size() > 0) {
                                    $(this).show().addClass('visible');
                                    found = true;
                                }
                            }
                            if ($(this).hasClass('visible')) {
                                visibleRowCount++;
                            }
                        });
                        if (text) {
                            parent.find(".rowCount").text("Matches: " + (visibleRowCount - (found ? 1 : 0)));
                        }
                        if (visibleRowCount == (found ? 1 : 0)) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo($(parent).find('table'));
                        }
                        $(parent).find("tr td").removeClass("dark");
                        $(parent).find("tr.visible:odd td").addClass("dark");
                    }

                    $(".datatable .closed").click(function () {
                        var parent = $(this).parent();
                        $(this).hide();
                        $(".filter", parent).fadeIn(function () {
                            $("input", parent).val("").focus().css("border", "1px solid #aaa");
                        });
                    });

                    $(".datatable .opened").click(function () {
                        var parent = $(this).parent().parent();
                        $(".filter", parent).fadeOut(function () {
                            $(".closed", parent).show();
                            $("input", parent).val("").each(function () {
                                window.updateDatatableFilter(this);
                            });
                        });
                    });

                    $(".datatable .filter input").keyup(function(e) {
                        window.updateDatatableFilter(this);
                        e.preventDefault();
                        e.stopPropagation();
                    });

                    $(".datatable table").each(function () {
                        var found = false;
                        $("tr", this).each(function () {
                            if (!found && $(this).find("th").size() == 0) {
                                found = true;
                            }
                        });
                        if (!found) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo(this);
                        }
                    });

                    // Applies styles to datatables.
                    $(".datatable").each(function () {
                        $(this).find("tr:first th").addClass("top");
                        $(this).find("tr:last td").addClass("bottom");
                        $(this).find("tr:odd td").addClass("dark");
                        $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                        $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                    });

                    $(".datatable table.tablesorter").each(function () {
                        $(this).bind("sortEnd", function () {
                            $(".datatable").each(function () {
                                $(this).find("th, td")
                                    .removeClass("top").removeClass("bottom")
                                    .removeClass("left").removeClass("right")
                                    .removeClass("dark");
                                $(this).find("tr:first th").addClass("top");
                                $(this).find("tr:last td").addClass("bottom");
                                $(this).find("tr:odd td").addClass("dark");
                                $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                                $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                            });
                        });
                    });
                }
        });
    </script>
            </div>
        </div>
        <script type="application/javascript">
            $(function() {
                $(".userListMarker").click(function() {
                    $.post("/data/lists", {action: "findTouched"}, function(json) {
                        Codeforces.facebox(".userListsFacebox");
                        var tbody = $("#facebox tbody");
                        tbody.empty();
                        for (var i in json) {
                            tbody.append(
                                    $("<tr></tr>").append(
                                            $("<td></td>").attr("data-readKey", json[i].readKey).text(json[i].name)
                                    )
                            );
                        }
                        Codeforces.updateDatatables();
                        tbody.find("td").css("cursor", "pointer").click(function() {
                            document.location = Codeforces.updateUrlParameter(document.location.href, "list", $(this).attr("data-readKey"));
                        });
                    }, "json");
                });
            });
        </script>


</div><div id="datepick-div" style="display: none;"></div><div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" style="display: none; padding-bottom: 42px; padding-right: 42px;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxLoadedContent" style="width: 0px; height: 0px; overflow: hidden; float: left;"></div><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><div id="cboxNext" style="float: left;"></div><div id="cboxPrevious" style="float: left;"></div><div id="cboxSlideshow" style="float: left;"></div><div id="cboxClose" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none;"></div></div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; min-width: 0px; max-width: none; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXSizeOneSym, sans-serif;"></div></div></body></html>